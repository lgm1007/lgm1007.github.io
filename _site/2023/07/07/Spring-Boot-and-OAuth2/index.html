<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Spring Boot and OAuth2</title>
  <meta name='description' content='Zolan is modern minimal theme for Jekyll'>

  <link rel="canonical" href="http://localhost:4000/2023/07/07/Spring-Boot-and-OAuth2/">
  <link rel="alternate" type="application/rss+xml" title="" href="/feed.xml">

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css?family=Roboto:400,700" rel="stylesheet">
  <!-- Ionicons -->
  <link href="https://unpkg.com/ionicons@4.2.2/dist/css/ionicons.min.css" rel="stylesheet">

  <style>
  
  .text-left{text-align:left}.text-right{text-align:right}.text-center{text-align:center}.text-justify{text-align:justify}.block{display:block}.inline-block{display:inline-block}.inline{display:inline}.vertical-center{display:flex;align-items:center;justify-content:center}.show{display:block}.hide{display:none}.invisible{visibility:hidden}.float-left{float:left}.float-right{float:right}.no-padding{padding:0}.no-margin{margin:0}.list-reset{list-style-type:none;margin:0;padding:0}.clearfix::after,.clearfix ::before{content:"";display:table;clear:both}.screen-reader-text{clip:rect(1px, 1px, 1px, 1px);height:1px;overflow:hidden;position:absolute !important;width:1px;word-wrap:normal !important}/*! normalize.css v8.0.0 | MIT License | github.com/necolas/normalize.css */html{line-height:1.15;-webkit-text-size-adjust:100%}body{margin:0}h1{font-size:2em;margin:.67em 0}hr{box-sizing:content-box;height:0;overflow:visible}pre{font-family:monospace,monospace;font-size:1em}a{background-color:rgba(0,0,0,0)}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:bolder}code,kbd,samp{font-family:monospace,monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-0.25em}sup{top:-0.5em}img{border-style:none}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0}button,input{overflow:visible}button,select{text-transform:none}button,[type=button],[type=reset],[type=submit]{-webkit-appearance:button}button::-moz-focus-inner,[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner{border-style:none;padding:0}button:-moz-focusring,[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring{outline:1px dotted ButtonText}fieldset{padding:.35em .75em .625em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}progress{vertical-align:baseline}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}details{display:block}summary{display:list-item}template{display:none}[hidden]{display:none}body,h1,h2,h3,h4,h5,h6,p,blockquote,pre,dl,dd,ol,ul,fieldset,legend,figure,hr{margin:0;padding:0}li>ul,li>ol{margin-bottom:0}table{border-collapse:collapse;border-spacing:0}h1,h2,h3,h4,h5,h6,ul,ol,dl,blockquote,p,address,hr,table,fieldset,figure,pre{margin-bottom:20px}ul,ol,dd{margin-left:20px}.highlight{background:#f8f8f8}.highlighter-rouge .highlight{background:#eef}.highlight .c{color:#998;font-style:italic}.highlight .err{color:#a61717;background-color:#e3d2d2}.highlight .k{font-weight:bold}.highlight .o{font-weight:bold}.highlight .cm{color:#998;font-style:italic}.highlight .cp{color:#999;font-weight:bold}.highlight .c1{color:#998;font-style:italic}.highlight .cs{color:#999;font-weight:bold;font-style:italic}.highlight .gd{color:#000;background-color:#fdd}.highlight .gd .x{color:#000;background-color:#faa}.highlight .ge{font-style:italic}.highlight .gr{color:#a00}.highlight .gh{color:#999}.highlight .gi{color:#000;background-color:#dfd}.highlight .gi .x{color:#000;background-color:#afa}.highlight .go{color:#888}.highlight .gp{color:#555}.highlight .gs{font-weight:bold}.highlight .gu{color:#aaa}.highlight .gt{color:#a00}.highlight .kc{font-weight:bold}.highlight .kd{font-weight:bold}.highlight .kp{font-weight:bold}.highlight .kr{font-weight:bold}.highlight .kt{color:#458;font-weight:bold}.highlight .m{color:#099}.highlight .s{color:#d14}.highlight .na{color:teal}.highlight .nb{color:#0086b3}.highlight .nc{color:#458;font-weight:bold}.highlight .no{color:teal}.highlight .ni{color:purple}.highlight .ne{color:#900;font-weight:bold}.highlight .nf{color:#900;font-weight:bold}.highlight .nn{color:#555}.highlight .nt{color:navy}.highlight .nv{color:teal}.highlight .ow{font-weight:bold}.highlight .w{color:#bbb}.highlight .mf{color:#099}.highlight .mh{color:#099}.highlight .mi{color:#099}.highlight .mo{color:#099}.highlight .sb{color:#d14}.highlight .sc{color:#d14}.highlight .sd{color:#d14}.highlight .s2{color:#d14}.highlight .se{color:#d14}.highlight .sh{color:#d14}.highlight .si{color:#d14}.highlight .sx{color:#d14}.highlight .sr{color:#009926}.highlight .s1{color:#d14}.highlight .ss{color:#990073}.highlight .bp{color:#999}.highlight .vc{color:teal}.highlight .vg{color:teal}.highlight .vi{color:teal}.highlight .il{color:#099}.container{max-width:1200px;padding-left:20px;padding-right:20px;margin:0 auto}.container-full{max-width:100%;padding-left:20px;padding-right:20px;margin:0 auto}.row{display:flex;flex-wrap:wrap;flex:0 1 auto;flex-direction:row;box-sizing:border-box;margin-left:-20px;margin-right:-20px}.col{padding-left:20px;padding-right:20px}[class^=col-]{flex:auto}.col-0{width:0%}.col-1{width:8.3333333333%}.col-2{width:16.6666666667%}.col-3{width:25%}.col-4{width:33.3333333333%}.col-5{width:41.6666666667%}.col-6{width:50%}.col-7{width:58.3333333333%}.col-8{width:66.6666666667%}.col-9{width:75%}.col-10{width:83.3333333333%}.col-11{width:91.6666666667%}.col-12{width:100%}.push-0{margin-left:0%}.push-1{margin-left:8.3333333333%}.push-2{margin-left:16.6666666667%}.push-3{margin-left:25%}.push-4{margin-left:33.3333333333%}.push-5{margin-left:41.6666666667%}.push-6{margin-left:50%}.push-7{margin-left:58.3333333333%}.push-8{margin-left:66.6666666667%}.push-9{margin-left:75%}.push-10{margin-left:83.3333333333%}.push-11{margin-left:91.6666666667%}.push-12{margin-left:100%}.pull-0{margin-right:0%}.pull-1{margin-right:8.3333333333%}.pull-2{margin-right:16.6666666667%}.pull-3{margin-right:25%}.pull-4{margin-right:33.3333333333%}.pull-5{margin-right:41.6666666667%}.pull-6{margin-right:50%}.pull-7{margin-right:58.3333333333%}.pull-8{margin-right:66.6666666667%}.pull-9{margin-right:75%}.pull-10{margin-right:83.3333333333%}.pull-11{margin-right:91.6666666667%}.pull-12{margin-right:100%}@media(max-width: 992px){.col-d-0{width:0%}.col-d-1{width:8.3333333333%}.col-d-2{width:16.6666666667%}.col-d-3{width:25%}.col-d-4{width:33.3333333333%}.col-d-5{width:41.6666666667%}.col-d-6{width:50%}.col-d-7{width:58.3333333333%}.col-d-8{width:66.6666666667%}.col-d-9{width:75%}.col-d-10{width:83.3333333333%}.col-d-11{width:91.6666666667%}.col-d-12{width:100%}.push-d-0{margin-left:0%}.push-d-1{margin-left:8.3333333333%}.push-d-2{margin-left:16.6666666667%}.push-d-3{margin-left:25%}.push-d-4{margin-left:33.3333333333%}.push-d-5{margin-left:41.6666666667%}.push-d-6{margin-left:50%}.push-d-7{margin-left:58.3333333333%}.push-d-8{margin-left:66.6666666667%}.push-d-9{margin-left:75%}.push-d-10{margin-left:83.3333333333%}.push-d-11{margin-left:91.6666666667%}.push-d-12{margin-left:100%}.pull-d-0{margin-right:0%}.pull-d-1{margin-right:8.3333333333%}.pull-d-2{margin-right:16.6666666667%}.pull-d-3{margin-right:25%}.pull-d-4{margin-right:33.3333333333%}.pull-d-5{margin-right:41.6666666667%}.pull-d-6{margin-right:50%}.pull-d-7{margin-right:58.3333333333%}.pull-d-8{margin-right:66.6666666667%}.pull-d-9{margin-right:75%}.pull-d-10{margin-right:83.3333333333%}.pull-d-11{margin-right:91.6666666667%}.pull-d-12{margin-right:100%}}@media(max-width: 768px){.col-t-0{width:0%}.col-t-1{width:8.3333333333%}.col-t-2{width:16.6666666667%}.col-t-3{width:25%}.col-t-4{width:33.3333333333%}.col-t-5{width:41.6666666667%}.col-t-6{width:50%}.col-t-7{width:58.3333333333%}.col-t-8{width:66.6666666667%}.col-t-9{width:75%}.col-t-10{width:83.3333333333%}.col-t-11{width:91.6666666667%}.col-t-12{width:100%}.push-t-0{margin-left:0%}.push-t-1{margin-left:8.3333333333%}.push-t-2{margin-left:16.6666666667%}.push-t-3{margin-left:25%}.push-t-4{margin-left:33.3333333333%}.push-t-5{margin-left:41.6666666667%}.push-t-6{margin-left:50%}.push-t-7{margin-left:58.3333333333%}.push-t-8{margin-left:66.6666666667%}.push-t-9{margin-left:75%}.push-t-10{margin-left:83.3333333333%}.push-t-11{margin-left:91.6666666667%}.push-t-12{margin-left:100%}.pull-t-0{margin-right:0%}.pull-t-1{margin-right:8.3333333333%}.pull-t-2{margin-right:16.6666666667%}.pull-t-3{margin-right:25%}.pull-t-4{margin-right:33.3333333333%}.pull-t-5{margin-right:41.6666666667%}.pull-t-6{margin-right:50%}.pull-t-7{margin-right:58.3333333333%}.pull-t-8{margin-right:66.6666666667%}.pull-t-9{margin-right:75%}.pull-t-10{margin-right:83.3333333333%}.pull-t-11{margin-right:91.6666666667%}.pull-t-12{margin-right:100%}}@media(max-width: 576px){.col-m-0{width:0%}.col-m-1{width:8.3333333333%}.col-m-2{width:16.6666666667%}.col-m-3{width:25%}.col-m-4{width:33.3333333333%}.col-m-5{width:41.6666666667%}.col-m-6{width:50%}.col-m-7{width:58.3333333333%}.col-m-8{width:66.6666666667%}.col-m-9{width:75%}.col-m-10{width:83.3333333333%}.col-m-11{width:91.6666666667%}.col-m-12{width:100%}.push-m-0{margin-left:0%}.push-m-1{margin-left:8.3333333333%}.push-m-2{margin-left:16.6666666667%}.push-m-3{margin-left:25%}.push-m-4{margin-left:33.3333333333%}.push-m-5{margin-left:41.6666666667%}.push-m-6{margin-left:50%}.push-m-7{margin-left:58.3333333333%}.push-m-8{margin-left:66.6666666667%}.push-m-9{margin-left:75%}.push-m-10{margin-left:83.3333333333%}.push-m-11{margin-left:91.6666666667%}.push-m-12{margin-left:100%}.pull-m-0{margin-right:0%}.pull-m-1{margin-right:8.3333333333%}.pull-m-2{margin-right:16.6666666667%}.pull-m-3{margin-right:25%}.pull-m-4{margin-right:33.3333333333%}.pull-m-5{margin-right:41.6666666667%}.pull-m-6{margin-right:50%}.pull-m-7{margin-right:58.3333333333%}.pull-m-8{margin-right:66.6666666667%}.pull-m-9{margin-right:75%}.pull-m-10{margin-right:83.3333333333%}.pull-m-11{margin-right:91.6666666667%}.pull-m-12{margin-right:100%}}@media(max-width: 992px){.col-d-0{width:0%}.col-d-1{width:8.3333333333%}.col-d-2{width:16.6666666667%}.col-d-3{width:25%}.col-d-4{width:33.3333333333%}.col-d-5{width:41.6666666667%}.col-d-6{width:50%}.col-d-7{width:58.3333333333%}.col-d-8{width:66.6666666667%}.col-d-9{width:75%}.col-d-10{width:83.3333333333%}.col-d-11{width:91.6666666667%}.col-d-12{width:100%}.push-d-0{margin-left:0%}.push-d-1{margin-left:8.3333333333%}.push-d-2{margin-left:16.6666666667%}.push-d-3{margin-left:25%}.push-d-4{margin-left:33.3333333333%}.push-d-5{margin-left:41.6666666667%}.push-d-6{margin-left:50%}.push-d-7{margin-left:58.3333333333%}.push-d-8{margin-left:66.6666666667%}.push-d-9{margin-left:75%}.push-d-10{margin-left:83.3333333333%}.push-d-11{margin-left:91.6666666667%}.push-d-12{margin-left:100%}.pull-d-0{margin-right:0%}.pull-d-1{margin-right:8.3333333333%}.pull-d-2{margin-right:16.6666666667%}.pull-d-3{margin-right:25%}.pull-d-4{margin-right:33.3333333333%}.pull-d-5{margin-right:41.6666666667%}.pull-d-6{margin-right:50%}.pull-d-7{margin-right:58.3333333333%}.pull-d-8{margin-right:66.6666666667%}.pull-d-9{margin-right:75%}.pull-d-10{margin-right:83.3333333333%}.pull-d-11{margin-right:91.6666666667%}.pull-d-12{margin-right:100%}}@media(max-width: 768px){.col-t-0{width:0%}.col-t-1{width:8.3333333333%}.col-t-2{width:16.6666666667%}.col-t-3{width:25%}.col-t-4{width:33.3333333333%}.col-t-5{width:41.6666666667%}.col-t-6{width:50%}.col-t-7{width:58.3333333333%}.col-t-8{width:66.6666666667%}.col-t-9{width:75%}.col-t-10{width:83.3333333333%}.col-t-11{width:91.6666666667%}.col-t-12{width:100%}.push-t-0{margin-left:0%}.push-t-1{margin-left:8.3333333333%}.push-t-2{margin-left:16.6666666667%}.push-t-3{margin-left:25%}.push-t-4{margin-left:33.3333333333%}.push-t-5{margin-left:41.6666666667%}.push-t-6{margin-left:50%}.push-t-7{margin-left:58.3333333333%}.push-t-8{margin-left:66.6666666667%}.push-t-9{margin-left:75%}.push-t-10{margin-left:83.3333333333%}.push-t-11{margin-left:91.6666666667%}.push-t-12{margin-left:100%}.pull-t-0{margin-right:0%}.pull-t-1{margin-right:8.3333333333%}.pull-t-2{margin-right:16.6666666667%}.pull-t-3{margin-right:25%}.pull-t-4{margin-right:33.3333333333%}.pull-t-5{margin-right:41.6666666667%}.pull-t-6{margin-right:50%}.pull-t-7{margin-right:58.3333333333%}.pull-t-8{margin-right:66.6666666667%}.pull-t-9{margin-right:75%}.pull-t-10{margin-right:83.3333333333%}.pull-t-11{margin-right:91.6666666667%}.pull-t-12{margin-right:100%}}@media(max-width: 576px){.col-m-0{width:0%}.col-m-1{width:8.3333333333%}.col-m-2{width:16.6666666667%}.col-m-3{width:25%}.col-m-4{width:33.3333333333%}.col-m-5{width:41.6666666667%}.col-m-6{width:50%}.col-m-7{width:58.3333333333%}.col-m-8{width:66.6666666667%}.col-m-9{width:75%}.col-m-10{width:83.3333333333%}.col-m-11{width:91.6666666667%}.col-m-12{width:100%}.push-m-0{margin-left:0%}.push-m-1{margin-left:8.3333333333%}.push-m-2{margin-left:16.6666666667%}.push-m-3{margin-left:25%}.push-m-4{margin-left:33.3333333333%}.push-m-5{margin-left:41.6666666667%}.push-m-6{margin-left:50%}.push-m-7{margin-left:58.3333333333%}.push-m-8{margin-left:66.6666666667%}.push-m-9{margin-left:75%}.push-m-10{margin-left:83.3333333333%}.push-m-11{margin-left:91.6666666667%}.push-m-12{margin-left:100%}.pull-m-0{margin-right:0%}.pull-m-1{margin-right:8.3333333333%}.pull-m-2{margin-right:16.6666666667%}.pull-m-3{margin-right:25%}.pull-m-4{margin-right:33.3333333333%}.pull-m-5{margin-right:41.6666666667%}.pull-m-6{margin-right:50%}.pull-m-7{margin-right:58.3333333333%}.pull-m-8{margin-right:66.6666666667%}.pull-m-9{margin-right:75%}.pull-m-10{margin-right:83.3333333333%}.pull-m-11{margin-right:91.6666666667%}.pull-m-12{margin-right:100%}}@media(max-width: 992px){.col-d-0{width:0%}.col-d-1{width:8.3333333333%}.col-d-2{width:16.6666666667%}.col-d-3{width:25%}.col-d-4{width:33.3333333333%}.col-d-5{width:41.6666666667%}.col-d-6{width:50%}.col-d-7{width:58.3333333333%}.col-d-8{width:66.6666666667%}.col-d-9{width:75%}.col-d-10{width:83.3333333333%}.col-d-11{width:91.6666666667%}.col-d-12{width:100%}.push-d-0{margin-left:0%}.push-d-1{margin-left:8.3333333333%}.push-d-2{margin-left:16.6666666667%}.push-d-3{margin-left:25%}.push-d-4{margin-left:33.3333333333%}.push-d-5{margin-left:41.6666666667%}.push-d-6{margin-left:50%}.push-d-7{margin-left:58.3333333333%}.push-d-8{margin-left:66.6666666667%}.push-d-9{margin-left:75%}.push-d-10{margin-left:83.3333333333%}.push-d-11{margin-left:91.6666666667%}.push-d-12{margin-left:100%}.pull-d-0{margin-right:0%}.pull-d-1{margin-right:8.3333333333%}.pull-d-2{margin-right:16.6666666667%}.pull-d-3{margin-right:25%}.pull-d-4{margin-right:33.3333333333%}.pull-d-5{margin-right:41.6666666667%}.pull-d-6{margin-right:50%}.pull-d-7{margin-right:58.3333333333%}.pull-d-8{margin-right:66.6666666667%}.pull-d-9{margin-right:75%}.pull-d-10{margin-right:83.3333333333%}.pull-d-11{margin-right:91.6666666667%}.pull-d-12{margin-right:100%}}@media(max-width: 768px){.col-t-0{width:0%}.col-t-1{width:8.3333333333%}.col-t-2{width:16.6666666667%}.col-t-3{width:25%}.col-t-4{width:33.3333333333%}.col-t-5{width:41.6666666667%}.col-t-6{width:50%}.col-t-7{width:58.3333333333%}.col-t-8{width:66.6666666667%}.col-t-9{width:75%}.col-t-10{width:83.3333333333%}.col-t-11{width:91.6666666667%}.col-t-12{width:100%}.push-t-0{margin-left:0%}.push-t-1{margin-left:8.3333333333%}.push-t-2{margin-left:16.6666666667%}.push-t-3{margin-left:25%}.push-t-4{margin-left:33.3333333333%}.push-t-5{margin-left:41.6666666667%}.push-t-6{margin-left:50%}.push-t-7{margin-left:58.3333333333%}.push-t-8{margin-left:66.6666666667%}.push-t-9{margin-left:75%}.push-t-10{margin-left:83.3333333333%}.push-t-11{margin-left:91.6666666667%}.push-t-12{margin-left:100%}.pull-t-0{margin-right:0%}.pull-t-1{margin-right:8.3333333333%}.pull-t-2{margin-right:16.6666666667%}.pull-t-3{margin-right:25%}.pull-t-4{margin-right:33.3333333333%}.pull-t-5{margin-right:41.6666666667%}.pull-t-6{margin-right:50%}.pull-t-7{margin-right:58.3333333333%}.pull-t-8{margin-right:66.6666666667%}.pull-t-9{margin-right:75%}.pull-t-10{margin-right:83.3333333333%}.pull-t-11{margin-right:91.6666666667%}.pull-t-12{margin-right:100%}}@media(max-width: 576px){.col-m-0{width:0%}.col-m-1{width:8.3333333333%}.col-m-2{width:16.6666666667%}.col-m-3{width:25%}.col-m-4{width:33.3333333333%}.col-m-5{width:41.6666666667%}.col-m-6{width:50%}.col-m-7{width:58.3333333333%}.col-m-8{width:66.6666666667%}.col-m-9{width:75%}.col-m-10{width:83.3333333333%}.col-m-11{width:91.6666666667%}.col-m-12{width:100%}.push-m-0{margin-left:0%}.push-m-1{margin-left:8.3333333333%}.push-m-2{margin-left:16.6666666667%}.push-m-3{margin-left:25%}.push-m-4{margin-left:33.3333333333%}.push-m-5{margin-left:41.6666666667%}.push-m-6{margin-left:50%}.push-m-7{margin-left:58.3333333333%}.push-m-8{margin-left:66.6666666667%}.push-m-9{margin-left:75%}.push-m-10{margin-left:83.3333333333%}.push-m-11{margin-left:91.6666666667%}.push-m-12{margin-left:100%}.pull-m-0{margin-right:0%}.pull-m-1{margin-right:8.3333333333%}.pull-m-2{margin-right:16.6666666667%}.pull-m-3{margin-right:25%}.pull-m-4{margin-right:33.3333333333%}.pull-m-5{margin-right:41.6666666667%}.pull-m-6{margin-right:50%}.pull-m-7{margin-right:58.3333333333%}.pull-m-8{margin-right:66.6666666667%}.pull-m-9{margin-right:75%}.pull-m-10{margin-right:83.3333333333%}.pull-m-11{margin-right:91.6666666667%}.pull-m-12{margin-right:100%}}img[data-action=zoom]{cursor:pointer;cursor:-webkit-zoom-in;cursor:-moz-zoom-in}.zoom-img,.zoom-img-wrap{position:relative;z-index:666;-webkit-transition:all 300ms;-o-transition:all 300ms;transition:all 300ms}img.zoom-img{cursor:pointer;cursor:-webkit-zoom-out;cursor:-moz-zoom-out}.zoom-overlay{z-index:420;background:#fff;position:fixed;top:0;left:0;right:0;bottom:0;pointer-events:none;opacity:0;-webkit-transition:opacity 300ms;-o-transition:opacity 300ms;transition:opacity 300ms}.zoom-overlay-open .zoom-overlay{opacity:1}.zoom-overlay-open,.zoom-overlay-transitioning{cursor:default}*,*::after,*::before{box-sizing:border-box}body{font-family:"Roboto",Helvetica Neue,Helvetica,Arial,sans-serif;font-size:16px;line-height:26px;color:#393e46;background-color:#fff;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}body input,body textarea{border:1px solid #e6eef0;outline:none}body input:focus:required:invalid,body textarea:focus:required:invalid{border-color:#e02f40}body input:required:valid,body textarea:required:valid{border-color:#34a74e}::placeholder{color:#666}*::selection{color:#fff;background-color:#393e46}h1,h2,h3,h4,h5,h6{font-family:"Roboto",Helvetica Neue,Helvetica,Arial,sans-serif;line-height:initial;letter-spacing:.5px}h1{font-size:36px}h2{font-size:28px}h3{font-size:24px}h4{font-size:20px}h5{font-size:18px}h6{font-size:16px}blockquote{margin:30px -100px;font-size:28px;line-height:45px;letter-spacing:.5px;font-style:normal;text-align:center}@media only screen and (max-width: 768px){blockquote{margin:30px 0;font-size:24px;line-height:38px}}pre{overflow:auto;padding:15px;margin-bottom:0;font-size:14px;white-space:pre-wrap;word-wrap:break-word;word-break:break-all}img,.zoom-img-wrap{max-width:100%;height:auto;vertical-align:middle}img+em,.zoom-img-wrap+em{text-align:center;display:block;font-style:normal;font-weight:normal;font-size:14px;color:#bbb}a{text-decoration:none;color:#f6b141;transition:all .35s}a:hover{color:#f49d10}a:active{color:#c87f09}hr{display:block;height:1px;margin:40px 0;border:0;background:#e6eef0}.top{position:fixed;bottom:40px;right:-100px;z-index:1;width:35px;height:35px;text-align:center;line-height:35px;background-color:#393e46;color:#fff;cursor:pointer;transition:all .25s ease}.top.is-active{right:40px}.top:hover{background-color:#000}@media only screen and (max-width: 768px){.top{bottom:25px}.top.is-active{right:30px}}.header{position:relative;height:100px}.header .header__overlay{position:fixed;top:0;right:0;bottom:0;left:0;z-index:10;background-color:rgba(17,17,17,.7);cursor:pointer;opacity:0;visibility:hidden;transition:all .5s ease}@media only screen and (max-width: 992px){.header .header__overlay.is-visible{opacity:1;visibility:visible}}.logo{position:absolute;top:50%;left:0;transform:translateY(-50%)}.logo .logo__link{font-size:30px;font-weight:700;letter-spacing:.5px;color:#393e46;text-decoration:none}.logo .logo__link:hover{color:#000}.logo .logo__image{max-height:50px}.main-nav{position:absolute;top:50%;left:50%;transform:translate(-50%, -50%)}.main-nav .nav-icon__close{display:none;font-size:24px;text-align:right;cursor:pointer}.main-nav .nav-icon__close:hover{color:#000}.main-nav .nav__title{display:none}.main-nav .nav__list{white-space:nowrap}.main-nav .nav__list .nav__item{display:inline-block}.main-nav .nav__list .nav__item .nav__link{display:inline-block;padding:10px 30px;font-size:14px;font-weight:700;letter-spacing:.5px;text-transform:uppercase;color:#393e46}.main-nav .nav__list .nav__item .nav__link:hover{color:#000}@media only screen and (max-width: 992px){.main-nav{position:fixed;top:0;left:inherit;right:-300px;bottom:0;transform:none;z-index:100;width:300px;height:100vh;padding:40px 30px 30px;transition:right .5s cubic-bezier(0.7, 0.4, 0, 1);background:#fff}.main-nav.is-open{right:0}.main-nav .nav-icon__close{display:block}.main-nav .nav__title{display:block;padding-left:30px;padding-bottom:7px;margin-bottom:10px;color:#bbb;border-bottom:1px solid #e6eef0}.main-nav .nav__list .nav__item{display:block}}.nav-buttons{position:absolute;top:50%;right:0;transform:translateY(-50%);font-size:21px}.nav-buttons .nav__icon{color:#393e46;cursor:pointer}.nav-buttons .nav__icon:hover{color:#000}.nav-buttons .nav__icon-menu{display:none;margin-right:10px}.nav-buttons .nav__icon-menu:hover{color:#000}@media only screen and (max-width: 992px){.nav-buttons .nav__icon-menu{display:inline-block}}.hero{padding:80px 0;margin-bottom:80px;background:#f5f5f5}.hero .last-item{display:flex}.hero .hero__content{display:flex;flex-direction:column;justify-content:center;width:100%;padding:0 40px 0 0}.hero .hero__content .hero__title{font-size:38px;font-weight:normal}.hero .hero__content .hero__subtitle{font-size:18px;line-height:32px;letter-spacing:.5px}.hero .hero__content .hero__social{display:flex}.hero .hero__content .hero__social-title{font-weight:700}.hero .hero__image img{box-shadow:0 1px 4px rgba(0,0,0,.15)}@media only screen and (max-width: 992px){.hero .hero__content{padding:0}.hero .hero__content .hero__subtitle{font-size:16px;line-height:28px}}@media only screen and (max-width: 768px){.hero{margin-bottom:40px}.hero .last-item{order:1}.hero .hero__content .hero__title{margin-bottom:20px;font-size:27px}.hero .hero__image{margin-bottom:20px}.hero .hero__image img{box-shadow:none}}@media only screen and (max-width: 576px){.hero{padding:40px 0}}.search{position:fixed;top:0;left:0;right:0;bottom:0;z-index:-1;transform:scale(0.95);opacity:0;background:#fff;transition:all 250ms ease}.search.is-visible{transform:scale(1);z-index:100;opacity:1;transition:all 250ms ease}.search__box{width:50%;margin:0 auto;padding-top:100px}@media only screen and (max-width: 992px){.search__box{width:70%;padding-top:70px}}@media only screen and (max-width: 576px){.search__box{width:100%;padding-top:30px}}.search__group{margin-bottom:50px}.search__group .search__close{margin-bottom:30px;font-size:27px;text-align:right;cursor:pointer}.search__group .search__close:hover{color:#000}.search__group .search__text{width:100%;padding:20px 20px 20px 30px;letter-spacing:.5px;border-radius:30px;border:1px solid #f8f8f8;color:#393e46;background:#f8f8f8}.search__group .search__text::placeholder{letter-spacing:.5px;color:rgba(57,62,70,.7)}.search-results-list{height:65vh;margin:0;padding:0 20px;list-style:decimal;overflow:auto;white-space:normal}.search-results-list .search-results__item{margin-bottom:10px;padding-left:10px;padding-bottom:10px;font-weight:700;border-bottom:1px solid #f5efef}.search-results-list .search-results__item:first-child{padding-top:20px;border-top:1px solid #f5efef}.search-results-list .search-results__link{font-size:18px;font-weight:700;letter-spacing:.5px;color:#393e46}.search-results-list .search-results__link:hover{color:#000}.search-results-list .search-results__date{font-size:12px;color:#bbb}.search-results-list .no-results{list-style:none;padding:20px 0;font-size:18px;font-weight:700;letter-spacing:.5px;border-top:1px solid #f5efef;border-bottom:1px solid #f5efef}.contact .contact__list li{margin-left:15px;display:inline-block}.contact .contact__list li a{font-size:18px;color:#bbb}.contact .contact__list li a:hover{color:#393e46}.pagination{margin:20px 0 40px;padding:40px 0;text-align:center}@media only screen and (max-width: 576px){.pagination{margin:0 0 20px}}.pagination__list{display:flex;justify-content:space-between;align-items:center}.pagination__list .next-link,.pagination__list .previous-link,.pagination__list .disabled{display:inline-block;width:140px;height:50px;line-height:50px;font-size:12px;letter-spacing:1px;text-transform:uppercase;transition:all .35s;box-shadow:0 1px 3px 0 rgba(0,0,0,.15);background:#fff}.pagination__list .next-link,.pagination__list .previous-link{color:#393e46}.pagination__list .next-link:hover,.pagination__list .previous-link:hover{color:#000}.pagination__list .disabled{color:#bbb;cursor:not-allowed}.pagination__list .counter-box a,.pagination__list .counter-box span{padding:0 5px;font-size:15px;color:#393e46}.pagination__list .counter-box .active-link{font-weight:700}@media only screen and (max-width: 576px){.pagination__list{flex-direction:column}.pagination__list .next-link,.pagination__list .previous-link,.pagination__list .disabled{margin:10px 0}}.subscribe{width:430px;max-width:100%;margin:0 auto 80px;text-align:center}.subscribe .subscribe__title{margin-bottom:10px;font-size:37px;line-height:57px}.subscribe .subscribe__subtitle{margin-bottom:30px;font-size:17px;line-height:27px}.subscribe .subscribe-form .subscribe-group{margin-bottom:30px}.subscribe .subscribe-form .subscribe__email{width:100%;padding:17px;font-size:16px;text-align:center;outline:none;border:none;border-bottom:3px solid #e6eef0}.subscribe .subscribe-form .subscribe__email::placeholder{font-size:18px;color:#e6eef0}.subscribe .subscribe-form .subscribe__button{width:127px;height:57px;font-size:14px;font-weight:700;letter-spacing:.5px;border-radius:30px;border:none;background:#e6eef0;cursor:pointer;transition:all .35s}.subscribe .subscribe-form .subscribe__button:hover{color:#fff;background:#393e46}@media only screen and (max-width: 576px){.subscribe{margin:0 auto 40px}.subscribe .subscribe__subtitle{font-size:16px;line-height:26px}}.instagram-box{position:relative;margin:0 0 80px}.instagram-box .istagram-contact{position:absolute;left:50%;top:50%;transform:translate(-50%, -50%);z-index:1;display:block;padding:8px 15px;font-size:14px;letter-spacing:.5px;border-radius:3px;box-shadow:0 4px 4px 0 rgba(0,0,0,.15);color:#393e46;background:#fff}.instagram-box .istagram-contact:hover{color:#000}.instagram-box .instagram .instagram-item{width:16.6%;display:inline-block;transition:all .35s}.instagram-box .instagram .instagram-item:hover{opacity:.9}@media only screen and (max-width: 768px){.instagram-box .instagram .instagram-item{width:33.3%}}@media only screen and (max-width: 576px){.instagram-box{margin:0 0 40px}}.footer{position:relative;padding:80px 0 40px;text-align:center;border-top:1px solid #e6eef0;background:#f5f5f5}.footer .contact{margin-bottom:15px}.footer .copyright a{color:#393e46}.footer .copyright a:hover{color:#f6b141}@media only screen and (max-width: 576px){.footer{padding:40px 0 20px}}.lates-title{position:relative;margin-bottom:80px;font-size:14px;line-height:24px;letter-spacing:1px;text-transform:uppercase;font-weight:normal;text-align:center}.lates-title:after,.lates-title:before{content:"";display:block;position:absolute;top:50%;transform:translateY(-50%);height:1px;background:#e6eef0}.lates-title:after{width:calc(50% - 90px);left:0}.lates-title:before{width:calc(50% - 90px);right:0}@media only screen and (max-width: 768px){.lates-title{margin-bottom:40px}.lates-title:after,.lates-title:before{width:calc(50% - 70px)}}.page-title-box{padding:80px 0;border-top:1px solid #e6eef0}.page-title-box .page-title{font-size:57px;line-height:70px;margin:0}@media only screen and (max-width: 576px){.page-title-box{padding:40px 0}.page-title-box .page-title{font-size:47px;line-height:53px}}.page__head .page-image{background-size:cover;background-position:center;background-repeat:no-repeat;background-color:#e6eef0}.page__head .page-image:after{content:"";display:table;width:100%;min-height:300px;padding-top:50%}.page{margin:80px auto}.page img{margin:30px 0}@media only screen and (max-width: 768px){.page{margin:40px auto}}.page-box{text-align:center}.page-box .back-arrow a{display:inline-block;margin-left:10px;color:#393e46;font-weight:700}.page-box .back-arrow a:hover{color:#000}.article{margin-bottom:40px}.article .article__wrapper{display:flex;align-items:center}.article .article__image{width:50%;display:block;background-position:center;background-size:cover;background-repeat:no-repeat;background-color:#e6eef0}.article .article__image:hover{opacity:.9}.article .article__image:after{content:"";display:table;width:100%;padding-bottom:70%}.article .article__content{width:60%;padding:50px;margin-left:-10%;z-index:1;border-radius:3px;background:rgba(255,255,255,.98);box-shadow:0 1px 4px rgba(0,0,0,.15)}.article .article__content .article__tag{font-size:12px;letter-spacing:.5px;font-weight:700;text-transform:uppercase}.article .article__content .article__title{margin-bottom:20px;font-size:30px}.article .article__content .article__title a{color:#393e46}.article .article__content .article__title a:hover{color:#000}.article .article__content .article__excerpt{margin-bottom:20px;font-size:16px;line-height:26px}.article .article__content .article__meta{font-size:12px;line-height:18px;text-transform:uppercase;color:#bbb}.article .article__content .article__footer{display:flex;align-items:center}.article .article__content .article__footer .read-more{margin-left:auto;padding-bottom:5px;font-size:12px;line-height:18px;letter-spacing:1px;text-transform:uppercase;border-bottom:1px solid rgba(0,0,0,0);color:#bbb}.article .article__content .article__footer .read-more:hover{color:#393e46;border-color:#f6b141}.article .article-without-image{width:100%;margin-left:auto}@media only screen and (max-width: 768px){.article .article__wrapper{flex-direction:column}.article .article__image{width:100%}.article .article__content{width:90%;padding:20px;margin:-10% 0 0 0}.article .article-without-image{width:90%;margin:0}}@media only screen and (max-width: 576px){.article .article__content .article__title{font-size:27px}}.post-title-box{padding:80px 0;border-top:1px solid #e6eef0}.post-title-box .post-title{margin-bottom:10px;width:500px;max-width:100%;font-size:57px;line-height:70px}.post-title-box .post__date{font-weight:700}@media only screen and (max-width: 576px){.post-title-box{padding:40px 0}.post-title-box .post-title{margin:10px 0;font-size:47px;line-height:53px}}.post__info{display:flex;align-items:center}.post__info .post__author{margin-right:10px;font-weight:700}.post__info .post__author .author-name{color:#bbb;border-bottom:1px solid rgba(0,0,0,0)}.post__info .post__author .author-name:hover{border-bottom:1px solid #bbb}.post__info .post__tags .post__tags-tag{position:relative;padding-left:15px;font-weight:700}.post__info .post__tags .post__tags-tag:before{content:"";position:absolute;top:50%;left:0;transform:translateY(-50%);width:5px;height:5px;border-radius:50%;background:#393e46}.post-image{background-size:cover;background-position:center;background-repeat:no-repeat;background-color:#e6eef0}.post-image:after{content:"";display:table;width:100%;min-height:300px;padding-top:50%}.post{margin:80px auto}.post.post-no-image{margin:0 auto 80px}@media only screen and (max-width: 576px){.post{margin:40px auto}.post.post-no-image{margin:0 auto 40px}}.post th,.post td{border:1px solid #393e46;padding-inline:15px}.post img{margin:30px 0}.post__content{margin-bottom:40px}.post__share{display:flex}.post__share .share__title{margin-right:10px;font-size:18px;font-weight:700;letter-spacing:.5px}.post__share .share__list .share__item{display:inline-block;margin:0 10px}.post__share .share__list .share__item a{font-size:18px;color:#bbb}.post__share .share__list .share__item a:hover{color:#393e46}.post__navigation{display:flex;align-items:baseline;margin-bottom:80px;padding-bottom:80px;border-bottom:1px solid #e6eef0}.post__navigation .prev,.post__navigation .next{flex:1 0 50%}.post__navigation .prev:last-child,.post__navigation .next:last-child{padding-right:0}.post__navigation .prev .post__nav__image,.post__navigation .next .post__nav__image{display:block;margin-bottom:40px;background-position:center;background-size:cover;background-repeat:no-repeat;background-color:#e6eef0;transition:.35s ease-in-out}.post__navigation .prev .post__nav__image:hover,.post__navigation .next .post__nav__image:hover{opacity:.9}.post__navigation .prev .post__nav__image:after,.post__navigation .next .post__nav__image:after{content:"";display:table;width:100%;padding-bottom:65%}.post__navigation .prev .post__nav__title,.post__navigation .next .post__nav__title{margin-bottom:20px;font-size:27px;line-height:37px;text-transform:uppercase;letter-spacing:2px;text-align:center}.post__navigation .prev .post__nav__title a,.post__navigation .next .post__nav__title a{display:inline-block;max-width:250px;padding:0 10px;vertical-align:middle;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;color:#393e46}.post__navigation .prev .post__nav__title a:hover,.post__navigation .next .post__nav__title a:hover{color:#000}.post__navigation .prev{padding-right:10px}.post__navigation .next{padding-left:10px}.post__navigation .prev__excerpt,.post__navigation .next__excerpt{width:100%;max-width:400px;margin:0 auto;text-align:center}@media only screen and (max-width: 768px){.post__navigation{flex-wrap:wrap}.post__navigation .prev,.post__navigation .next{flex:1 0 100%;padding:0}.post__navigation .next{margin-top:40px}}@media only screen and (max-width: 576px){.post__navigation{margin-bottom:40px;padding-bottom:40px}.post__navigation .prev .post__nav__image,.post__navigation .next .post__nav__image{margin-bottom:20px}}.comments{margin-bottom:80px}@media only screen and (max-width: 576px){.comments{margin-bottom:40px}}.arhive-head{padding:80px 0;margin-bottom:40px;background:#f5f5f5}.arhive-head .archive-title{text-align:center;font-weight:normal}.arhive-head .archive-title span{font-weight:700}@media only screen and (max-width: 576px){.arhive-head{margin-bottom:40px}}
  </style>
</head>

<body>

  

  <div class="container">
  <div class="row">
    <div class="col col-12">
      <!-- begin header -->
      <header class="header">

        <div class="logo">
          <a class="logo__link" href="/">
          
            <img class="logo__image" src="/images/logo.svg" alt="Gmlee">
          
          </a>
        </div>

        <nav class="main-nav">

          <div class="main-nav__box">
            <div class="nav-icon__close">
              <i class="ion ion-ios-close-circle-outline"></i>
            </div>

            <div class="nav__title">Menu</div>

            <ul class="nav__list list-reset">
              <li class="nav__item">
                <a href="/" class="nav__link">Home</a>
              </li>
              
                
              
                
              
              <li class="nav__item">
                <a href="/about/" class="nav__link">About</a>
              </li>
              
                
              
                
              
              <li class="nav__item">
                <a href="/blog.html" class="nav__link">Blogs</a>
              </li>
              
                
              
                
              
              <li class="nav__item">
                <a href="/contact.html" class="nav__link">Contacts</a>
              </li>
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
            </ul>

          </div>
        </nav>

        <div class="nav-buttons">
          <i class="nav__icon nav__icon-menu ion ion-md-menu" aria-label="Menu Icon"></i>
          <i class="nav__icon nav__icon-search ion ion-md-search" aria-label="Search Icon"></i>
        </div>

        <div class="header__overlay"></div>
      </header>
      <!-- end header -->
    </div>
  </div>
</div>

  <!-- begin content -->
  <main class="content" aria-label="Content">
    <div class="container">
  <div class="post-title-box">
    <div class="row">
      <div class="col col-10 push-2 col-11 push-t-1 col-m-12 push-m-0">
        <span class="post__date">
          <time datetime="2023-07-07T19:49:55+09:00">Jul 07, 2023</time>
        </span>

        <h1 class="post-title">Spring Boot and OAuth2</h1>

        <div class="post__info">
          <div class="post__author">
            <span>By</span>
            <a href="/about/" class="author-name">Gyumyung Lee</a>
          </div>

          
          <div class="post__tags">
            
              <a href="/tag/reference" class="post__tags-tag">reference</a>
            
          </div>
          
        </div>
      </div>
    </div>
  </div>

  
  
    <div class="post__head">
      <div class="post-image" style="background-image: url(/images/post-6.jpg)"></div>
    </div>
  

  </div>


  <div class="container">
  <div class="row">
    <!-- begin post -->
    <article class="post  col col-8 col-t-10 col-m-12">

      <div class="post__content">
        <h2 id="spring-boot-and-oauth2">Spring Boot and OAuth2</h2>
<p>이 가이드는 <a href="https://datatracker.ietf.org/doc/html/rfc6749">OAuth 2.0</a>과 Spring Boot을 사용하여 “소셜 로그인”으로 다양한 작업을 수행하는 샘플 앱을 구축하는 방법을 보여줍니다.<br /></p>

<p>단순한 단일 공급자 싱글 사인-온 (single-provider single-sign on) 으로 시작하여 <a href="https://github.com/settings/developers">GitHub</a> 또는 <a href="https://developers.google.com/identity/protocols/OpenIDConnect">Google</a> 중에서 인증 공급자를 선택할 수 있는 클라이언트가 작동합니다. <br />
샘플은 모두 백엔드에 Spring Boot 및 Spring Security를 사용하는 단일 페이지 앱입니다. 또한 모두 프론트 엔드에 일반 jQuery를 사용합니다. 그러나 다른 javascript 프레임워크로 변환하거나 서버 측 렌더링을 사용하는 데 필요한 변경사항은 거의 없습니다. <br /></p>

<p>모든 샘플은 <a href="https://docs.spring.io/spring-boot/docs/current-SNAPSHOT/reference/htmlsingle/#web.security.oauth2">Spring Boot의 기본 OAuth 2.0 지원</a>을 사용하여 구현됩니다. <br />
여러 개의 샘플이 서로 구축되어 각 단계에서 새 기능을 추가합니다: <br /></p>
<ul>
  <li><a href="https://spring.io/guides/tutorials/spring-boot-oauth2/#_social_login_simple">simple</a> : Spring Boot의 OAuth 2.0 구성 속성을 통해 홈 페이지와 무조건 로그인만 가능한 매우 기본적인 정적 앱입니다(홈 페이지를 방문하면 GitHub로 자동 리디렉션됩니다).</li>
  <li><a href="https://spring.io/guides/tutorials/spring-boot-oauth2/#_social_login_click">click</a> : 사용자가 로그인하기 위해 클릭해야 하는 명시적 링크를 추가합니다.</li>
  <li><a href="https://spring.io/guides/tutorials/spring-boot-oauth2/#_social_login_logout">logout</a> : 인증된 사용자에 대한 로그아웃 링크도 추가합니다.</li>
  <li><a href="https://spring.io/guides/tutorials/spring-boot-oauth2/#_social_login_two_providers">two-providers</a> : 홈 페이지에서 사용할 로그인 공급자를 선택할 수 있도록 두 번째 로그인 공급자를 추가합니다.</li>
  <li><a href="https://spring.io/guides/tutorials/spring-boot-oauth2/#_social_login_custom_error">custom-error</a> : 인증되지 않은 사용자에 대한 오류 메시지와 GitHub의 API를 기반으로 한 사용자 정의 인증을 추가합니다.</li>
</ul>

<p>각 앱을 IDE로 가져올 수 있습니다. <code class="language-plaintext highlighter-rouge">SocialApplication</code>에서 <code class="language-plaintext highlighter-rouge">main</code> 메소드를 실행하여 앱을 시작할 수 있습니다. 모두 http://localhost:8080 에 홈페이지가 나타납니다. (로그인하여 내용을 보려면 GitHub 및 Google 계정이 필요합니다.) <br />
또한 <code class="language-plaintext highlighter-rouge">mvn spring-boot:run</code>을 사용하거나 jar 파일을 빌드하고 <code class="language-plaintext highlighter-rouge">mvn package</code> 및 <code class="language-plaintext highlighter-rouge">java -jar target/*.jar</code> (Spring Boot 문서 및 기타 사용 가능한 설명서에 따라) 를 사용하여 커맨드 라인에서 모든 앱을 실행할 수 있습니다. 만약 최상위 레벨에서 wrapper를 사용한다면 Maven을 설치할 필요가 없습니다. <br /></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ cd simple
$ ../mvnw package
$ java -jar target/*.jar
</code></pre></div></div>
<hr />

<p>앱들은 모두 <code class="language-plaintext highlighter-rouge">localhost:8080</code>에서 작동합니다. 왜냐하면 그들은 GitHub과 Google에 등록된 OAuth 2.0 클라이언트를 그 주소로 사용할 것이기 때문입니다. 다른 호스트 또는 포트에서 실행하려면 해당 방법으로 앱을 등록해야 합니다. 기본값을 사용하는 경우 localhost를 넘어 자격 증명이 유출될 위험이 없습니다. 그러나 인터넷에 노출되는 내용에 주의하고, 자신의 앱 등록을 공개 소스 제어에 넣지 마십시오.</p>

<hr />
<h3 id="github를-사용한-single-sign-on">GitHub를 사용한 Single Sign On</h3>
<p>인증에 GitHub를 사용하는 최소 애플리케이션을 만들 수 있습니다. Spring Boot의 자동 구성 기능을 활용하면 해당 작업이 상당히 쉬워집니다. <br /></p>

<h4 id="새-프로젝트-만들기">새 프로젝트 만들기</h4>
<p>먼저 Spring Boot 애플리케이션을 만들어야 하는데, 이 애플리케이션은 여러 가지 방법으로 수행할 수 있습니다. <br />
가장 쉬운 방법은 https://start.spring.io 으로 이동하여 빈 프로젝트를 생성하는 것입니다. (Web dependency를 시작점으로 선택) <br />
마찬가지로 명령줄에서 해당 작업을 수행합니다: <br /></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ mkdir ui &amp;&amp; cd ui
$ curl https://start.spring.io/starter.tgz -d style=web -d name=simple | tar -xzvf -
</code></pre></div></div>
<p><br /></p>

<h4 id="홈-페이지-추가하기">홈 페이지 추가하기</h4>
<p>새 프로젝트에서 <code class="language-plaintext highlighter-rouge">src/main/resources/static</code> 경로에 <code class="language-plaintext highlighter-rouge">index.html</code>을 생성합니다. 일부 스타일시트와 JavaScript 링크를 추가하여 결과를 다음과 같이 표시해야 합니다: <br /></p>

<p>index.html</p>
<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;!doctype html&gt;</span>
<span class="nt">&lt;html</span> <span class="na">lang=</span><span class="s">"en"</span><span class="nt">&gt;</span>
<span class="nt">&lt;head&gt;</span>
    <span class="nt">&lt;meta</span> <span class="na">charset=</span><span class="s">"utf-8"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;meta</span> <span class="na">http-equiv=</span><span class="s">"X-UA-Compatible"</span> <span class="na">content=</span><span class="s">"IE=edge"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;title&gt;</span>Demo<span class="nt">&lt;/title&gt;</span>
    <span class="nt">&lt;meta</span> <span class="na">name=</span><span class="s">"description"</span> <span class="na">content=</span><span class="s">""</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;meta</span> <span class="na">name=</span><span class="s">"viewport"</span> <span class="na">content=</span><span class="s">"width=device-width"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;base</span> <span class="na">href=</span><span class="s">"/"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">"stylesheet"</span> <span class="na">type=</span><span class="s">"text/css"</span> <span class="na">href=</span><span class="s">"/webjars/bootstrap/css/bootstrap.min.css"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;script </span><span class="na">type=</span><span class="s">"text/javascript"</span> <span class="na">src=</span><span class="s">"/webjars/jquery/jquery.min.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
    <span class="nt">&lt;script </span><span class="na">type=</span><span class="s">"text/javascript"</span> <span class="na">src=</span><span class="s">"/webjars/bootstrap/js/bootstrap.min.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;/head&gt;</span>
<span class="nt">&lt;body&gt;</span>
	<span class="nt">&lt;h1&gt;</span>Demo<span class="nt">&lt;/h1&gt;</span>
	<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"container"</span><span class="nt">&gt;&lt;/div&gt;</span>
<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</code></pre></div></div>
<p>이 중 어느 것도 OAuth 2.0 로그인 기능을 시연하는 데 필요하지 않지만, 마지막에는 쾌적한 UI가 있으면 좋을 것이므로 홈 페이지에서 기본적인 것부터 시작하는 것이 좋습니다. <br /></p>

<p>앱을 시작하고 홈 페이지를 로드하면 스타일시트가 로드되지 않은 것을 알 수 있습니다. 따라서 jQuery와 Twitter Bootstrap을 추가하여 추가해야 합니다: <br /></p>

<p>pom.xml</p>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;dependency&gt;</span>
	<span class="nt">&lt;groupId&gt;</span>org.webjars<span class="nt">&lt;/groupId&gt;</span>
	<span class="nt">&lt;artifactId&gt;</span>jquery<span class="nt">&lt;/artifactId&gt;</span>
	<span class="nt">&lt;version&gt;</span>3.4.1<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
<span class="nt">&lt;dependency&gt;</span>
	<span class="nt">&lt;groupId&gt;</span>org.webjars<span class="nt">&lt;/groupId&gt;</span>
	<span class="nt">&lt;artifactId&gt;</span>bootstrap<span class="nt">&lt;/artifactId&gt;</span>
	<span class="nt">&lt;version&gt;</span>4.3.1<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
<span class="nt">&lt;dependency&gt;</span>
	<span class="nt">&lt;groupId&gt;</span>org.webjars<span class="nt">&lt;/groupId&gt;</span>
	<span class="nt">&lt;artifactId&gt;</span>webjars-locator-core<span class="nt">&lt;/artifactId&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</code></pre></div></div>

<p>마지막 종속성은 webjars 사이트에서 라이브러리로 제공하는 webjars “locator” 입니다. Spring은 정확한 버전을 알 필요 없이 locator를 사용하여 webjars에서 정적 자원들을 찾을 수 있습니다. <br />
(<code class="language-plaintext highlighter-rouge">index.html</code>의 버전 없는 <code class="language-plaintext highlighter-rouge">/webjars/**</code> 링크) <br />
MVC 자동 구성을 끄지 않는 한 webjars locator는 Spring Boot 앱에서 기본적으로 활성화됩니다. <br /></p>

<p>이러한 변경 사항이 적용되면, 당신은 당신의 앱을 위한 멋진 홈페이지를 갖게 될 것입니다. <br /></p>

<h4 id="github-및-spring-security를-통한-애플리케이션-보안">GitHub 및 Spring Security를 통한 애플리케이션 보안</h4>
<p>애플리케이션의 보안을 강화하려면 Spring Security를 종속성으로 추가하기만 하면 됩니다. “소셜” 로그인 (GitHub 위임) 을 수행하려면 Spring Security OAuth 2.0 Client 스타터를 추가해야 합니다: <br /></p>

<p>pom.xml</p>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;dependency&gt;</span>
	<span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
	<span class="nt">&lt;artifactId&gt;</span>spring-boot-starter-oauth2-client<span class="nt">&lt;/artifactId&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</code></pre></div></div>
<p>이를 추가하면 기본적으로 OAuth 2.0으로 앱을 보호합니다. <br /></p>

<p>다음으로 GitHub을 인증 공급자로 사용하도록 앱을 구성해야 합니다. 이 작업을 수행하려면 다음을 수행합니다: <br /></p>
<ul>
  <li><a href="#새로운-GitHub-애플리케이션-추가">새로운 GitHub 애플리케이션 추가</a></li>
  <li><a href="#application.yml-구성">application.yml 구성</a></li>
  <li><a href="#애플리케이션-부팅">애플리케이션 부팅</a></li>
</ul>

<h4 id="새로운-github-애플리케이션-추가">새로운 GitHub 애플리케이션 추가</h4>
<p>로그인에 GitHub의 OAuth 2.0 인증 시스템을 사용하려면 먼저 <a href="https://github.com/settings/developers">새 GitHub 앱을 추가해야 합니다.</a> <br /></p>

<p>“New OAuth App”을 선택하면 “Register a new OAuth application” 페이지가 표시됩니다. 앱 이름과 설명을 입력한 후, 앱의 홈 페이지(이 경우 http://localhost:8080)를 입력합니다. 마지막으로, 인증 콜백 URL을 <code class="language-plaintext highlighter-rouge">http://localhost:8080/login/oauth2/code/github</code> 으로 지정하고 “Register Application”을 클릭합니다. <br /></p>

<p>OAuth 리디렉션 URI는 최종 사용자의 사용자 에이전트가 GitHub로 인증되고 인증 애플리케이션 페이지에서 애플리케이션에 대한 액세스 권한을 부여한 후 다시 리디렉션되는 애플리케이션의 경로입니다.</p>

<hr />

<p>기본 리디렉션 URI 템플릿은 <code class="language-plaintext highlighter-rouge">{baseUrl}/login/oauth2/code/{registrationId}</code> 입니다. <em>registrationId</em>는 <code class="language-plaintext highlighter-rouge">클라이언트 등록의 고유 식별자</code>입니다.</p>

<hr />

<h4 id="applicationyml-구성">application.yml 구성</h4>
<p>그런 다음 GitHub에 대한 링크를 만들려면 <code class="language-plaintext highlighter-rouge">application.yml</code>에 다음을 추가합니다: <br /></p>
<div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">spring</span><span class="pi">:</span>
  <span class="na">security</span><span class="pi">:</span>
    <span class="na">oauth2</span><span class="pi">:</span>
      <span class="na">client</span><span class="pi">:</span>
        <span class="na">registration</span><span class="pi">:</span>
          <span class="na">github</span><span class="pi">:</span>
            <span class="na">clientId</span><span class="pi">:</span> <span class="s">github-client-id</span>
            <span class="na">clientSecret</span><span class="pi">:</span> <span class="s">github-client-secret</span>
<span class="c1"># ...</span>
</code></pre></div></div>
<p>GitHub으로 방금 만든 OAuth 2.0 자격 증명을 사용하여 <code class="language-plaintext highlighter-rouge">github-client-id</code>를 클라이언트 ID로, <code class="language-plaintext highlighter-rouge">github-client-secret</code>을 클라이언트 secret으로 바꾸기만 하면 됩니다. <br /></p>

<h4 id="애플리케이션-부팅">애플리케이션 부팅</h4>
<p>이렇게 변경하고, 앱을 다시 실행한 후 http://localhost:8080 주소로 홈 페이지를 방문할 수 있습니다. 이제 홈 페이지 대신 GitHub로 로그인하도록 리다이렉션됩니다. 이 작업을 수행하고 요청된 모든 권한을 수락하면 로컬 애플리케이션으로 다시 리디렉션되고 홈 페이지가 표시됩니다. <br /></p>

<p>GitHub에 로그인한 상태를 유지하면 쿠키나 캐시된 데이터가 없는 새로운 브라우저에서 GitHub를 열어도 이 로컬 애플리케이션으로 다시 인증할 필요 없습니다. (Single Sign On은 이것을 의미합니다.) <br /></p>

<hr />

<p>샘플 응용프로그램을 사용하여 이 섹션을 수행하는 경우 브라우저 캐시에서 쿠키 및 HTTP 기본 자격 증명을 지워야 합니다. 단일 서버에 대한 가장 좋은 방법은 새 private 창을 여는 것입니다.</p>

<hr />

<p>로컬에서 실행되는 앱만 토큰을 사용할 수 있고 요청하는 범위가 제한되어 있으므로 이 샘플에 대한 액세스 권한을 부여하는 것이 안전합니다. 하지만 다음과 같은 앱에 로그인할 때 무엇을 승인하는지 유의해야 합니다: 이는 사용자를 편하게 하는 것보다 더 많은 작업을 수행할 수 있는 권한을 요청할 수 있습니다. (사용자에게 이익이 될 것 같지 않은 개인 데이터를 변경할 수 있는 권한을 요청할 수 있습니다.) <br /></p>

<h4 id="what-just-happened">What Just Happened?</h4>
<p>방금 작성한 앱은 OAuth 2.0 용어로 클라이언트 애플리케이션이며, GitHub(Authorization Server)에서 액세스 토큰을 얻기 위해 <a href="https://datatracker.ietf.org/doc/html/rfc6749#section-4">권한 코드 부여</a>를 사용합니다. <br /></p>

<p>그런 다음 액세스 토큰을 사용하여 GitHub에 로그인 ID 및 이름을 포함한 일부 개인 정보(사용자가 허용한 작업만)를 요청합니다. 이 단계에서 GitHub는 사용자가 보내는 토큰을 디코딩하고 앱이 사용자의 세부 정보에 액세스할 수 있는 권한을 부여하는지 확인하는 리소스 서버 역할을 합니다. 이 프로세스가 성공하면 사용자가 인증되도록 앱이 Spring Security 컨텍스트에 사용자 세부 정보를 삽입합니다. <br /></p>

<p>브라우저 도구 (Chrome 또는 Firefox의 F12)를 살펴보고 모든 hops에 대한 네트워크 트래픽을 추적하면 GitHub로 앞뒤로 리디렉션되고 마지막으로 새로운 Set-Cookie 헤더가 있는 홈 페이지로 돌아갑니다. 이 쿠키(기본적으로 JSESSIONID)는 Spring(또는 서블릿 기반) 애플리케이션에 대한 인증 세부사항에 대한 토큰입니다. <br /></p>

<p>따라서 사용자가 외부 공급자(GitHub)를 통해 인증해야 하는 콘텐츠를 확인할 수 있는 안전한 애플리케이션이 있습니다. <br /></p>

<p>우리는 그것을 인터넷 뱅킹 웹사이트에 사용하고 싶지 않을 것입니다. 그러나 기본적인 식별 목적과 사이트의 다른 사용자 간에 컨텐츠를 분리하는 것은 훌륭한 출발점입니다. 그래서 요즘 이런 인증이 굉장히 인기가 많습니다. <br /></p>

<p>다음 섹션에서는 애플리케이션에 몇 가지 기본 기능을 추가할 것입니다. 또한 사용자가 GitHub으로 초기 리디렉션할 때 무슨 일이 일어나고 있는지를 사용자에게 좀 더 분명하게 보여줄 것입니다. <br /></p>

<h3 id="시작-페이지-추가">시작 페이지 추가</h3>
<p>GitHub로 로그인할 수 있는 명시적인 링크를 추가하여 방금 만든 간단한 앱을 수정합니다. 새 링크는 즉시 리디렉션되지 않고 홈 페이지에 표시되며, 사용자는 로그인하거나 인증되지 않은 상태로 유지하도록 선택할 수 있습니다. 사용자가 링크를 클릭한 경우에만 보안 내용이 렌더링됩니다. <br /></p>

<h4 id="홈-페이지의-조건부-내용">홈 페이지의 조건부 내용</h4>
<p>사용자 인증확인을 조건으로 내용을 렌더링하려면 서버측 또는 클라이언트측 렌더링 중 하나를 선택할 수 있습니다. 여기서 JQuery를 사용하여 클라이언트 쪽을 변경합니다. 하지만 다른 것을 사용하는 것을 선호한다면 클라이언트 코드를 변환하는 것이 그리 어렵지 않을 것입니다. <br /></p>

<p>동적 콘텐츠를 시작하려면 다음과 같은 몇 가지 HTML 요소를 표시해야 합니다: <br />
index.html</p>
<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"container unauthenticated"</span><span class="nt">&gt;</span>
    With GitHub: <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/oauth2/authorization/github"</span><span class="nt">&gt;</span>click here<span class="nt">&lt;/a&gt;</span>
<span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"container authenticated"</span> <span class="na">style=</span><span class="s">"display:none"</span><span class="nt">&gt;</span>
    Logged in as: <span class="nt">&lt;span</span> <span class="na">id=</span><span class="s">"user"</span><span class="nt">&gt;&lt;/span&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</code></pre></div></div>
<p>기본적으로 첫 번째 <code class="language-plaintext highlighter-rouge">&lt;div&gt;</code>는 표시되고 두 번째는 표시되지 않습니다. <code class="language-plaintext highlighter-rouge">ID</code> 속성이 있는 빈 <code class="language-plaintext highlighter-rouge">&lt;span&gt;</code>도 참고하십시오. <br />
잠시 후 로그인한 사용자 세부 정보를 JSON으로 반환하는 서버 측 끝점을 추가합니다. <br />
하지만 먼저, 다음 JavaScript를 추가하여 해당 엔드포인트에 도달합니다. 엔드포인트의 응답에 따라 이 JavaScript는 <code class="language-plaintext highlighter-rouge">&lt;span&gt;</code> 태그를 사용자 이름으로 채우고 <code class="language-plaintext highlighter-rouge">&lt;div&gt;</code>를 적절하게 전환합니다: <br />
index.html</p>
<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;script </span><span class="na">type=</span><span class="s">"text/javascript"</span><span class="nt">&gt;</span>
    <span class="nx">$</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="dl">"</span><span class="s2">/user</span><span class="dl">"</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
        <span class="nf">$</span><span class="p">(</span><span class="dl">"</span><span class="s2">#user</span><span class="dl">"</span><span class="p">).</span><span class="nf">html</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span>
        <span class="nf">$</span><span class="p">(</span><span class="dl">"</span><span class="s2">.unauthenticated</span><span class="dl">"</span><span class="p">).</span><span class="nf">hide</span><span class="p">()</span>
        <span class="nf">$</span><span class="p">(</span><span class="dl">"</span><span class="s2">.authenticated</span><span class="dl">"</span><span class="p">).</span><span class="nf">show</span><span class="p">()</span>
    <span class="p">});</span>
<span class="nt">&lt;/script&gt;</span>
</code></pre></div></div>
<p>이 JavaScript는 서버 측 엔드포인트를 <code class="language-plaintext highlighter-rouge">/user</code>로 호출합니다. <br /></p>

<h4 id="user-엔드포인트"><code class="language-plaintext highlighter-rouge">/user</code> 엔드포인트</h4>
<p>이제 방금 언급한 서버 측 엔드포인트를 <code class="language-plaintext highlighter-rouge">/user</code>라고 추가합니다. 그러면 현재 로그인한 사용자가 다시 전송됩니다. 이 작업은 main 클래스에서 매우 쉽게 수행할 수 있습니다: <br />
SocialApplication.java</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@SpringBootApplication</span>
<span class="nd">@RestController</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SocialApplication</span> <span class="o">{</span>

    <span class="nd">@GetMapping</span><span class="o">(</span><span class="s">"/user"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Object</span><span class="o">&gt;</span> <span class="nf">user</span><span class="o">(</span><span class="nd">@AuthenticationPrincipal</span> <span class="nc">OAuth2User</span> <span class="n">principal</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="nc">Collections</span><span class="o">.</span><span class="na">singletonMap</span><span class="o">(</span><span class="s">"name"</span><span class="o">,</span> <span class="n">principal</span><span class="o">.</span><span class="na">getAttribute</span><span class="o">(</span><span class="s">"name"</span><span class="o">));</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">SpringApplication</span><span class="o">.</span><span class="na">run</span><span class="o">(</span><span class="nc">SocialApplication</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">args</span><span class="o">);</span>
    <span class="o">}</span>

<span class="o">}</span>
</code></pre></div></div>
<p><code class="language-plaintext highlighter-rouge">@RestController</code>, <code class="language-plaintext highlighter-rouge">@GetMapping</code> 및 handler 메서드에 주입된 <code class="language-plaintext highlighter-rouge">OAuth2User</code>를 사용합니다. <br /></p>

<hr />

<p>엔드포인트에 전체 <code class="language-plaintext highlighter-rouge">OAuth2User</code>를 반환하는 것은 좋은 생각이 아닙니다. 엔드포인트에는 브라우저 클라이언트에 공개하지 않으려는 정보가 포함되어 있을 수 있기 때문입니다.</p>

<hr />

<h4 id="홈-페이지를-public하게-하기">홈 페이지를 Public하게 하기</h4>
<p>마지막으로 변경해야 할 사항이 있습니다. <br /></p>

<p>이제 이 앱은 이전과 같이 정상적으로 작동하고 인증되지만 페이지를 표시하기 전에 리디렉션됩니다. 링크를 표시하려면 <code class="language-plaintext highlighter-rouge">WebSecurityConfigurerAdapter</code>를 상속받아 홈 페이지의 보안을 해제해야 합니다: <br />
SocialApplication.java</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@SpringBootApplication</span>
<span class="nd">@RestController</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SocialApplication</span> <span class="kd">extends</span> <span class="nc">WebSecurityConfigurerAdapter</span> <span class="o">{</span>

    <span class="c1">// ...</span>

    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">configure</span><span class="o">(</span><span class="nc">HttpSecurity</span> <span class="n">http</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
    	<span class="c1">// @formatter:off</span>
        <span class="n">http</span>
            <span class="o">.</span><span class="na">authorizeRequests</span><span class="o">(</span><span class="n">a</span> <span class="o">-&gt;</span> <span class="n">a</span>
                <span class="o">.</span><span class="na">antMatchers</span><span class="o">(</span><span class="s">"/"</span><span class="o">,</span> <span class="s">"/error"</span><span class="o">,</span> <span class="s">"/webjars/**"</span><span class="o">).</span><span class="na">permitAll</span><span class="o">()</span>
                <span class="o">.</span><span class="na">anyRequest</span><span class="o">().</span><span class="na">authenticated</span><span class="o">()</span>
            <span class="o">)</span>
            <span class="o">.</span><span class="na">exceptionHandling</span><span class="o">(</span><span class="n">e</span> <span class="o">-&gt;</span> <span class="n">e</span>
                <span class="o">.</span><span class="na">authenticationEntryPoint</span><span class="o">(</span><span class="k">new</span> <span class="nc">HttpStatusEntryPoint</span><span class="o">(</span><span class="nc">HttpStatus</span><span class="o">.</span><span class="na">UNAUTHORIZED</span><span class="o">))</span>
            <span class="o">)</span>
            <span class="o">.</span><span class="na">oauth2Login</span><span class="o">();</span>
        <span class="c1">// @formatter:on</span>
    <span class="o">}</span>

<span class="o">}</span>
</code></pre></div></div>
<p>Spring Boot는 <code class="language-plaintext highlighter-rouge">@SpringBootApplication</code>으로 주석이 달린 클래스의 <code class="language-plaintext highlighter-rouge">WebSecurityConfigurerAdapter</code>에 특별한 의미를 부여합니다: 이를 사용하여 OAuth 2.0 인증 프로세서를 전송하는 보안 필터 체인을 구성합니다. <br /></p>

<p>위의 구성은 허용된 엔드포인트의 화이트리스트를 나타내며, 다른 모든 엔드포인트는 인증이 필요합니다. <br />
허용할 항목</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">/</code>: 인증되지 않은 사용자가 일부 내용을 볼 수 있도록 동적으로 만든 페이지이기 때문입니다.</li>
  <li><code class="language-plaintext highlighter-rouge">/error</code>: 오류를 표시하는 Spring Boot 끝점이기 때문입니다.</li>
  <li><code class="language-plaintext highlighter-rouge">/webjars/**</code>: 인증 여부와 상관없이 모든 방문자에 대해 JavaScript를 실행하기를 원하기 때문입니다.</li>
</ul>

<p>그러나 이 구성에서는 <code class="language-plaintext highlighter-rouge">/user</code>에 대한 내용을 볼 수 없습니다. configuration 마지막에 <code class="language-plaintext highlighter-rouge">.anyRequest().authenticated()</code> 로 인해 지정되지 않는 한 <code class="language-plaintext highlighter-rouge">/user</code>를 포함한 모든 항목은 보안 상태를 유지하기 때문입니다. <br /></p>

<p>마지막으로, Ajax를 통해 백엔드와 인터페이스하므로 로그인 페이지로 리디렉션하는 기본 동작 대신 401로 응답하도록 엔드포인트를 구성하려고 합니다. <code class="language-plaintext highlighter-rouge">authenticationEntryPoint</code>를 구성하면 이 작업이 수행할 수 있습니다. <br /></p>

<p>이러한 변경 사항이 적용되어 애플리케이션이 완료되었으며, 이를 실행하고 홈 페이지를 방문하면 “GitHub로 로그인”하는 멋진 스타일의 HTML 링크를 볼 수 있습니다. 링크를 통해 GitHub로 직접 이동하는 것이 아니라 인증을 처리하는 로컬 경로로 이동하고 GitHub로 리디렉션됩니다. 인증이 완료되면 로컬 앱으로 다시 리디렉션되고, 이제 사용자 이름이 표시됩니다. (GitHub에서 해당 데이터에 대한 액세스 권한을 설정했다고 가정) <br /></p>

<h3 id="로그아웃-버튼-추가">로그아웃 버튼 추가</h3>
<p>사용자가 앱에서 로그아웃할 수 있는 버튼을 추가하여 구축한 <a href="https://spring.io/guides/tutorials/spring-boot-oauth2/#_social_login_click">클릭</a> 앱을 수정합니다. 이 기능은 단순한 기능처럼 보이지만 구현에는 약간의 주의가 필요하므로 정확한 방법을 논의해야 합니다. 대부분의 변경 사항은 앱을 읽기 전용 리소스에서 읽기-쓰기 리소스로 변환하고 있기 때문에(로그아웃 시 상태 변경 필요), 정적 컨텐츠가 아닌 실제 애플리케이션에서도 동일한 변경 사항이 필요합니다. <br /></p>

<h4 id="클라이언트-사이드-변경">클라이언트 사이드 변경</h4>
<p>클라이언트에서 로그아웃 버튼과 서버에 다시 호출하여 인증 취소를 요청할 수 있는 JavaScript를 제공하기만 하면 됩니다. 먼저 UI의 “authenticated” 섹션에서 다음과 같은 버튼을 추가합니다: <br />
index.html</p>
<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"container authenticated"</span><span class="nt">&gt;</span>
  Logged in as: <span class="nt">&lt;span</span> <span class="na">id=</span><span class="s">"user"</span><span class="nt">&gt;&lt;/span&gt;</span>
  <span class="nt">&lt;div&gt;</span>
    <span class="nt">&lt;button</span> <span class="na">onClick=</span><span class="s">"logout()"</span> <span class="na">class=</span><span class="s">"btn btn-primary"</span><span class="nt">&gt;</span>Logout<span class="nt">&lt;/button&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</code></pre></div></div>
<p>그런 다음 JavaScript에서 참조하는 <code class="language-plaintext highlighter-rouge">logout()</code> 함수를 제공합니다: <br />
index.html</p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">logout</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">$</span><span class="p">.</span><span class="nf">post</span><span class="p">(</span><span class="dl">"</span><span class="s2">/logout</span><span class="dl">"</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="nf">$</span><span class="p">(</span><span class="dl">"</span><span class="s2">#user</span><span class="dl">"</span><span class="p">).</span><span class="nf">html</span><span class="p">(</span><span class="dl">''</span><span class="p">);</span>
        <span class="nf">$</span><span class="p">(</span><span class="dl">"</span><span class="s2">.unauthenticated</span><span class="dl">"</span><span class="p">).</span><span class="nf">show</span><span class="p">();</span>
        <span class="nf">$</span><span class="p">(</span><span class="dl">"</span><span class="s2">.authenticated</span><span class="dl">"</span><span class="p">).</span><span class="nf">hide</span><span class="p">();</span>
    <span class="p">})</span>
    <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>
<p><code class="language-plaintext highlighter-rouge">logout()</code> 기능은 POST to <code class="language-plaintext highlighter-rouge">/logout</code>을 수행한 다음 동적 컨텐츠를 지웁니다. 이제 서버 측으로 전환하여 해당 엔드포인트를 구현할 수 있습니다. <br /></p>

<h4 id="로그아웃-엔드포인트-추가">로그아웃 엔드포인트 추가</h4>
<p>Spring Security는 <code class="language-plaintext highlighter-rouge">/logout</code> 엔드포인트에 대한 지원 기능을 제공합니다. (세션 삭제 및 쿠키 무효화) 엔드포인트를 구성하려면 <code class="language-plaintext highlighter-rouge">WebSecurityConfigurerAdapter</code>의 기존 <code class="language-plaintext highlighter-rouge">configure()</code> 메서드를 상속받기만 하면 됩니다: <br />
SocialApplication.java</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Override</span>
<span class="kd">protected</span> <span class="kt">void</span> <span class="nf">configure</span><span class="o">(</span><span class="nc">HttpSecurity</span> <span class="n">http</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
	<span class="c1">// @formatter:off</span>
    <span class="n">http</span>
        <span class="c1">// ... existing code here</span>
        <span class="o">.</span><span class="na">logout</span><span class="o">(</span><span class="n">l</span> <span class="o">-&gt;</span> <span class="n">l</span>
            <span class="o">.</span><span class="na">logoutSuccessUrl</span><span class="o">(</span><span class="s">"/"</span><span class="o">).</span><span class="na">permitAll</span><span class="o">()</span>
        <span class="o">)</span>
        <span class="c1">// ... existing code here</span>
    <span class="c1">// @formatter:on</span>
<span class="o">}</span>
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">/logout</code> 엔드포인트는 <code class="language-plaintext highlighter-rouge">/logout</code> 엔드포인트에 POST해야 하며, 사용자를 사이트 간 요청 위조(Cross Site Request Forgery; CSRF) 로부터 보호하려면 요청에 토큰을 포함해야 합니다. 토큰의 값은 보호 기능을 제공하는 현재 세션에 연결되어 있으므로 해당 데이터를 JavaScript 앱으로 가져올 수 있는 방법이 필요합니다. <br /></p>

<p>많은 JavaScript 프레임워크는 CSRF (Angular에서 XSRF라고 부르는)를 지원하지만, Spring Security의 기본 동작과는 약간 다른 방식으로 구현되는 경우가 많습니다. <br />
예를 들어, Angular에서 프런트 엔드는 서버가 “XSRF-TOKEN”이라는 쿠키를 전송하고 이를 확인하면 “X-XSRF-TOKEN”이라는 헤더로 값을 다시 전송합니다. 단순한 jQuery 클라이언트에서도 동일한 동작을 구현할 수 있으며, 서버 측 변경사항은 변경사항이 없거나 거의 없이 다른 프론트 엔드 구현과 함께 작동합니다. <br />
Spring Security에 이를 알려주기 위해서는 쿠키를 생성하는 필터를 추가해야 합니다. <br /></p>

<p><code class="language-plaintext highlighter-rouge">WebSecurityConfigurerAdapter</code>에서 다음 작업을 수행합니다: <br />
SocialApplication.java</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Override</span>
<span class="kd">protected</span> <span class="kt">void</span> <span class="nf">configure</span><span class="o">(</span><span class="nc">HttpSecurity</span> <span class="n">http</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
	<span class="c1">// @formatter:off</span>
    <span class="n">http</span>
        <span class="c1">// ... existing code here</span>
        <span class="o">.</span><span class="na">csrf</span><span class="o">(</span><span class="n">c</span> <span class="o">-&gt;</span> <span class="n">c</span>
            <span class="o">.</span><span class="na">csrfTokenRepository</span><span class="o">(</span><span class="nc">CookieCsrfTokenRepository</span><span class="o">.</span><span class="na">withHttpOnlyFalse</span><span class="o">())</span>
        <span class="o">)</span>
        <span class="c1">// ... existing code here</span>
    <span class="c1">// @formatter:on</span>
<span class="o">}</span>
</code></pre></div></div>
<p><br /></p>

<h4 id="클라이언트에서-csrf-토큰-추가">클라이언트에서 CSRF 토큰 추가</h4>
<p>이 샘플에서는 더 높은 수준의 프레임워크를 사용하지 않으므로 백엔드에서 쿠키로 사용할 수 있도록 만든 CSRF 토큰을 명시적으로 추가해야 합니다. 코드를 조금 더 간단하게 만들려면 <code class="language-plaintext highlighter-rouge">js-cookie</code> 라이브러리를 포함합니다: <br />
pom.xml</p>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>org.webjars<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>js-cookie<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;version&gt;</span>2.1.0<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</code></pre></div></div>
<p>그런 다음 HTML에서 참조할 수 있습니다: <br />
index.html</p>
<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;script </span><span class="na">type=</span><span class="s">"text/javascript"</span> <span class="na">src=</span><span class="s">"/webjars/js-cookie/js.cookie.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
</code></pre></div></div>
<p>마지막으로 XHR에서 <code class="language-plaintext highlighter-rouge">Cookies</code> 편리성 방법을 사용할 수 있습니다: <br />
index.html</p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">$</span><span class="p">.</span><span class="nf">ajaxSetup</span><span class="p">({</span>
  <span class="na">beforeSend</span> <span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">xhr</span><span class="p">,</span> <span class="nx">settings</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if </span><span class="p">(</span><span class="nx">settings</span><span class="p">.</span><span class="nx">type</span> <span class="o">==</span> <span class="dl">'</span><span class="s1">POST</span><span class="dl">'</span> <span class="o">||</span> <span class="nx">settings</span><span class="p">.</span><span class="nx">type</span> <span class="o">==</span> <span class="dl">'</span><span class="s1">PUT</span><span class="dl">'</span>
        <span class="o">||</span> <span class="nx">settings</span><span class="p">.</span><span class="nx">type</span> <span class="o">==</span> <span class="dl">'</span><span class="s1">DELETE</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if </span><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="sr">/^http:.*/</span><span class="p">.</span><span class="nf">test</span><span class="p">(</span><span class="nx">settings</span><span class="p">.</span><span class="nx">url</span><span class="p">)</span> <span class="o">||</span> <span class="sr">/^https:.*/</span>
        <span class="p">.</span><span class="nf">test</span><span class="p">(</span><span class="nx">settings</span><span class="p">.</span><span class="nx">url</span><span class="p">)))</span> <span class="p">{</span>
        <span class="c1">// Only send the token to relative URLs i.e. locally.</span>
        <span class="nx">xhr</span><span class="p">.</span><span class="nf">setRequestHeader</span><span class="p">(</span><span class="dl">"</span><span class="s2">X-XSRF-TOKEN</span><span class="dl">"</span><span class="p">,</span>
          <span class="nx">Cookies</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="dl">'</span><span class="s1">XSRF-TOKEN</span><span class="dl">'</span><span class="p">));</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">});</span>
</code></pre></div></div>
<h4 id="준비-완료">준비 완료!</h4>
<p>이러한 변경 사항이 적용되면 앱을 실행하고 새 <a href="https://spring.io/guides/tutorials/spring-boot-oauth2/#_social_login_logout">로그아웃</a> 버튼을 사용해 볼 준비가 되었습니다. 앱을 시작하고 홈 페이지를 새 브라우저 창에 로드합니다. “로그인” 링크를 클릭하여 GitHub으로 이동합니다. (이미 로그인한 경우에는 리디렉션이 표시되지 않을 수 있습니다.) 현재 세션을 취소하고 앱을 인증되지 않은 상태로 되돌리려면 “로그아웃” 버튼을 클릭하십시오. 궁금한 경우 브라우저가 로컬 서버와 교환하는 요청에서 새 쿠키 및 헤더를 볼 수 있습니다. <br /></p>

<p>이제 로그아웃 엔드포인트가 브라우저 클라이언트와 함께 작동하면 다른 모든 HTTP Request (POST, PUT, DELETE 등)도 마찬가지로 작동합니다. 따라서 이 플랫폼은 좀 더 현실적인 기능을 갖춘 애플리케이션을 위한 좋은 플랫폼이 될 것입니다. <br /></p>

<h3 id="github로-로그인">GitHub로 로그인</h3>
<p>이미 구축한 로그아웃 앱을 수정하여 스티커 페이지를 추가하여 최종 사용자가 여러 자격 증명 집합 중에서 선택할 수 있도록 합니다. <br /></p>

<p>최종 사용자를 위한 두 번째 옵션으로 Google을 추가합니다. <br /></p>

<h5 id="최초-설치">최초 설치</h5>
<p>로그인에 Google의 OAuth 2.0 인증 시스템을 사용하려면 Google API 콘솔에서 프로젝트를 설정하여 OAuth 2.0 자격 증명을 얻어야 합니다. <br /></p>

<hr />

<p>인증을 위한 <a href="https://developers.google.com/identity/openid-connect/openid-connect?hl=ko">Google의 OAuth 2.0 구현</a>은 <a href="https://openid.net/developers/how-connect-works/">OpenID Connect 1.0</a> 사양을 준수하며 <a href="https://openid.net/certification/">OpenID 인증</a>을 받았습니다.</p>

<hr />
<p><br />
“Outh 2.0 설정” 섹션에서 시작하는 OpenID 연결 페이지에 대한 지침을 따릅니다. “OAuth 2.0 자격 증명 가져오기” 지침을 완료한 후 클라이언트 ID와 클라이언트 암호로 구성된 자격 증명을 가진 새 OAuth 클라이언트를 만들어야 합니다. <br /></p>

<h4 id="리디렉션-uri-설정">리디렉션 URI 설정</h4>

<p>이전에 GitHub에 대해 했던 것처럼 리디렉션 URI를 제공해야 합니다. <br /></p>

<p>리디렉션 URI 설정 하위 섹션에서 인증된 리디렉션 URI 필드가 <code class="language-plaintext highlighter-rouge">http://localhost:8080/login/oauth2/code/google</code> 로 설정되어 있는지 확인합니다. <br /></p>

<h4 id="클라이언트-등록-추가">클라이언트 등록 추가</h4>

<p>그런 다음 Google을 가리키도록 클라이언트를 구성해야 합니다. Spring Security는 여러 클라이언트를 염두에 두고 구축되었으므로 GitHub용으로 작성한 자격 증명과 함께 Google 자격 증명을 추가할 수 있습니다: <br />
application.yml</p>
<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">spring</span><span class="pi">:</span>
  <span class="na">security</span><span class="pi">:</span>
    <span class="na">oauth2</span><span class="pi">:</span>
      <span class="na">client</span><span class="pi">:</span>
        <span class="na">registration</span><span class="pi">:</span>
          <span class="na">github</span><span class="pi">:</span>
            <span class="na">clientId</span><span class="pi">:</span> <span class="s">github-client-id</span>
            <span class="na">clientSecret</span><span class="pi">:</span> <span class="s">github-client-secret</span>
          <span class="na">google</span><span class="pi">:</span>
            <span class="na">client-id</span><span class="pi">:</span> <span class="s">google-client-id</span>
            <span class="na">client-secret</span><span class="pi">:</span> <span class="s">google-client-secret</span>
</code></pre></div></div>
<p>보시다시피 Google은 Spring Security에서 즉시 지원을 제공하는 또 다른 공급업체입니다. <br /></p>

<h4 id="로그인-링크-추가">로그인 링크 추가</h4>

<p>클라이언트에서 변경 사항은 다른 링크를 추가하면 됩니다: <br />
index.html</p>
<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"container unauthenticated"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;div&gt;</span>
    With GitHub: <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/oauth2/authorization/github"</span><span class="nt">&gt;</span>click here<span class="nt">&lt;/a&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;div&gt;</span>
    With Google: <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/oauth2/authorization/google"</span><span class="nt">&gt;</span>click here<span class="nt">&lt;/a&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</code></pre></div></div>

<hr />

<p>URL의 최종 경로는 <code class="language-plaintext highlighter-rouge">application.yml</code>의 클라이언트 등록 ID와 일치해야 합니다. <br /></p>

<p>Spring Security에는 <code class="language-plaintext highlighter-rouge">/oauth2/authorization/{registrationId}</code> 대신 <code class="language-plaintext highlighter-rouge">/login</code>을 가리키면 도달할 수 있는 기본 제공자 선택 페이지가 함께 제공됩니다.</p>

<hr />

<h4 id="로컬-사용자-데이터베이스-추가-방법">로컬 사용자 데이터베이스 추가 방법</h4>

<p>인증이 외부 공급자에게 위임된 경우에도 대부분의 응용프로그램은 사용자에 대한 데이터를 로컬로 보관해야 합니다. 여기에서는 코드를 보여주지 않지만 두 단계로 쉽게 수행할 수 있습니다. <br /></p>

<ol>
  <li>데이터베이스의 백엔드를 선택하고 사용자 요구에 적합하고 외부 인증에서 전체 또는 부분적으로 채울 수 있는 사용자 지정 <code class="language-plaintext highlighter-rouge">User</code> 객체에 대한 일부 리포지토리(예: Spring Data 사용)를 설정합니다.</li>
  <li><code class="language-plaintext highlighter-rouge">OAuth2UserService</code>를 implement 하고 권한 부여 서버와 데이터베이스를 호출합니다. 해당 implement는 권한 부여 서버를 호출하는 작업을 많이 수행하는 기본 구현으로 위임할 수 있습니다. implement는 사용자 지정 <code class="language-plaintext highlighter-rouge">User</code> 객체를 상속하고 <code class="language-plaintext highlighter-rouge">OAuth2User</code>를 implement하는 것을 반환해야 합니다.</li>
</ol>

<p>힌트: <code class="language-plaintext highlighter-rouge">User</code> 객체에 필드를 추가하여 외부 공급자의 고유 식별자(사용자 이름이 아니라 외부 공급자의 계정에 고유한 식별자)에 연결합니다. <br /></p>

<h3 id="인증되지-않은-사용자에-대한-오류-페이지-추가">인증되지 않은 사용자에 대한 오류 페이지 추가</h3>

<p>인증할 수 없는 사용자에게 피드백을 제공하기 위해 이전에 구축한 두 개의 브라우저 앱을 수정합니다. 동시에 사용자가 특정 GitHub 조직에 속해 있는 경우에만 허용하는 규칙을 포함하도록 인증 로직을 확장합니다. <br />
“조직 (organization)”은 GitHub 도메인별 개념이지만 다른 공급자를 위해 유사한 규칙이 고안될 수 있습니다. 예를 들어 Google을 사용하면 특정 도메인의 사용자만 인증할 수 있습니다. <br /></p>

<h4 id="github로-전환">GitHub로 전환</h4>

<p>구축한 두 개의 예제는 GitHub를 OAuth 2.0 공급자로 사용합니다. <br /></p>

<p>application.yml</p>
<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">spring</span><span class="pi">:</span>
  <span class="na">security</span><span class="pi">:</span>
    <span class="na">oauth2</span><span class="pi">:</span>
      <span class="na">client</span><span class="pi">:</span>
        <span class="na">registration</span><span class="pi">:</span>
          <span class="na">github</span><span class="pi">:</span>
            <span class="na">client-id</span><span class="pi">:</span> <span class="s">bd1c0a783ccdd1c9b9e4</span>
            <span class="na">client-secret</span><span class="pi">:</span> <span class="s">1a9030fbca47a5b2c28e92f19050bb77824b5ad1</span>
          <span class="c1"># ...</span>
</code></pre></div></div>

<h4 id="클라이언트에서-인증-실패-감지">클라이언트에서 인증 실패 감지</h4>
<p>클라이언트에서 인증할 수 없는 사용자에게 피드백을 제공할 수 있습니다. 이를 용이하게 하기 위해 정보 메시지를 추가할 <code class="language-plaintext highlighter-rouge">div</code> 태그를 추가할 수 있습니다. <br /></p>

<p>index.html</p>
<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"container text-danger error"</span><span class="nt">&gt;&lt;/div&gt;</span>
</code></pre></div></div>

<p>그런 다음 <code class="language-plaintext highlighter-rouge">/error</code> 엔드포인트에 호출을 추가하여 다음과 같은 결과를 <code class="language-plaintext highlighter-rouge">&lt;div&gt;</code>에 입력합니다: <br /></p>

<p>index.html</p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">$</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="dl">"</span><span class="s2">/error</span><span class="dl">"</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if </span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
        <span class="nf">$</span><span class="p">(</span><span class="dl">"</span><span class="s2">.error</span><span class="dl">"</span><span class="p">).</span><span class="nf">html</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nf">$</span><span class="p">(</span><span class="dl">"</span><span class="s2">.error</span><span class="dl">"</span><span class="p">).</span><span class="nf">html</span><span class="p">(</span><span class="dl">''</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">});</span>
</code></pre></div></div>

<p>오류 함수는 백엔드에서 표시할 오류가 있는지 확인합니다. <br /></p>

<h4 id="오류-메시지-추가">오류 메시지 추가</h4>

<p>오류 메시지 검색을 지원하려면 인증이 실패할 때 오류 메시지를 캡처해야 합니다. 이를 위해 다음과 같이 <code class="language-plaintext highlighter-rouge">AuthenticationFailureHandler</code>를 구성할 수 있습니다: <br /></p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">protected</span> <span class="kt">void</span> <span class="nf">configure</span><span class="o">(</span><span class="nc">HttpSecurity</span> <span class="n">http</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
	<span class="c1">// @formatter:off</span>
	<span class="n">http</span>
	    <span class="c1">// ... existing configuration</span>
	    <span class="o">.</span><span class="na">oauth2Login</span><span class="o">(</span><span class="n">o</span> <span class="o">-&gt;</span> <span class="n">o</span>
            <span class="o">.</span><span class="na">failureHandler</span><span class="o">((</span><span class="n">request</span><span class="o">,</span> <span class="n">response</span><span class="o">,</span> <span class="n">exception</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="o">{</span>
			    <span class="n">request</span><span class="o">.</span><span class="na">getSession</span><span class="o">().</span><span class="na">setAttribute</span><span class="o">(</span><span class="s">"error.message"</span><span class="o">,</span> <span class="n">exception</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
			    <span class="n">handler</span><span class="o">.</span><span class="na">onAuthenticationFailure</span><span class="o">(</span><span class="n">request</span><span class="o">,</span> <span class="n">response</span><span class="o">,</span> <span class="n">exception</span><span class="o">);</span>
            <span class="o">})</span>
        <span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>

<p>인증이 실패할 때마다 오류 메시지가 세션에 저장됩니다. <br />
그런 다음 다음과 같은 단순한 <code class="language-plaintext highlighter-rouge">/error</code> 컨트롤러를 추가할 수 있습니다: <br /></p>

<p>SocialApplication.java</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@GetMapping</span><span class="o">(</span><span class="s">"/error"</span><span class="o">)</span>
<span class="kd">public</span> <span class="nc">String</span> <span class="nf">error</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">request</span><span class="o">)</span> <span class="o">{</span>
	<span class="nc">String</span> <span class="n">message</span> <span class="o">=</span> <span class="o">(</span><span class="nc">String</span><span class="o">)</span> <span class="n">request</span><span class="o">.</span><span class="na">getSession</span><span class="o">().</span><span class="na">getAttribute</span><span class="o">(</span><span class="s">"error.message"</span><span class="o">);</span>
	<span class="n">request</span><span class="o">.</span><span class="na">getSession</span><span class="o">().</span><span class="na">removeAttribute</span><span class="o">(</span><span class="s">"error.message"</span><span class="o">);</span>
	<span class="k">return</span> <span class="n">message</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>

<hr />

<p>이렇게 하면 앱의 기본 /error 페이지가 대체되며, 이는 당사의 경우에는 괜찮지만 사용자의 요구에 맞게 정교하지 않을 수 있습니다.</p>

<hr />

<h4 id="서버에서-401-생성">서버에서 401 생성</h4>

<p>사용자가 GitHub로 로그인할 수 없거나 로그인을 원하지 않는 경우 Spring Security에서 401 응답이 이미 전송되므로 인증에 실패한 경우(예: 토큰 부여 거부) 앱이 이미 작동하고 있습니다. <br /></p>

<p>이를 개선하기 위해 인증 규칙을 확장하여 올바른 조직에 없는 사용자를 거부할 수 있습니다. <br />
GitHub API를 사용하여 사용자에 대해 자세히 알아볼 수 있으므로 인증 프로세스의 오른쪽 부분에 연결하기만 하면 됩니다. <br /></p>

<p>다행히도 스프링 부트는 이러한 간단한 사용 사례에 대해 다음과 같은 쉬운 확장 지점을 제공했습니다: <br />
<code class="language-plaintext highlighter-rouge">OAuth2UserService</code> 유형의 <code class="language-plaintext highlighter-rouge">@Bean</code>을 선언하면 사용자 주체를 식별하는 데 사용됩니다. 이 후크를 사용하여 사용자가 올바른 조직에 있다고 주장하고, 그렇지 않은 경우 예외를 던질 수 있습니다: <br /></p>

<p>SocialApplication.java</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Bean</span>
<span class="kd">public</span> <span class="nc">OAuth2UserService</span><span class="o">&lt;</span><span class="nc">OAuth2UserRequest</span><span class="o">,</span> <span class="nc">OAuth2User</span><span class="o">&gt;</span> <span class="nf">oauth2UserService</span><span class="o">(</span><span class="nc">WebClient</span> <span class="n">rest</span><span class="o">)</span> <span class="o">{</span>
    <span class="nc">DefaultOAuth2UserService</span> <span class="n">delegate</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">DefaultOAuth2UserService</span><span class="o">();</span>
    <span class="k">return</span> <span class="n">request</span> <span class="o">-&gt;</span> <span class="o">{</span>
        <span class="nc">OAuth2User</span> <span class="n">user</span> <span class="o">=</span> <span class="n">delegate</span><span class="o">.</span><span class="na">loadUser</span><span class="o">(</span><span class="n">request</span><span class="o">);</span>
        <span class="k">if</span> <span class="o">(!</span><span class="s">"github"</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">request</span><span class="o">.</span><span class="na">getClientRegistration</span><span class="o">().</span><span class="na">getRegistrationId</span><span class="o">()))</span> <span class="o">{</span>
        	<span class="k">return</span> <span class="n">user</span><span class="o">;</span>
        <span class="o">}</span>

        <span class="nc">OAuth2AuthorizedClient</span> <span class="n">client</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">OAuth2AuthorizedClient</span>
                <span class="o">(</span><span class="n">request</span><span class="o">.</span><span class="na">getClientRegistration</span><span class="o">(),</span> <span class="n">user</span><span class="o">.</span><span class="na">getName</span><span class="o">(),</span> <span class="n">request</span><span class="o">.</span><span class="na">getAccessToken</span><span class="o">());</span>
        <span class="nc">String</span> <span class="n">url</span> <span class="o">=</span> <span class="n">user</span><span class="o">.</span><span class="na">getAttribute</span><span class="o">(</span><span class="s">"organizations_url"</span><span class="o">);</span>
        <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Object</span><span class="o">&gt;&gt;</span> <span class="n">orgs</span> <span class="o">=</span> <span class="n">rest</span>
                <span class="o">.</span><span class="na">get</span><span class="o">().</span><span class="na">uri</span><span class="o">(</span><span class="n">url</span><span class="o">)</span>
                <span class="o">.</span><span class="na">attributes</span><span class="o">(</span><span class="n">oauth2AuthorizedClient</span><span class="o">(</span><span class="n">client</span><span class="o">))</span>
                <span class="o">.</span><span class="na">retrieve</span><span class="o">()</span>
                <span class="o">.</span><span class="na">bodyToMono</span><span class="o">(</span><span class="nc">List</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
                <span class="o">.</span><span class="na">block</span><span class="o">();</span>

        <span class="k">if</span> <span class="o">(</span><span class="n">orgs</span><span class="o">.</span><span class="na">stream</span><span class="o">().</span><span class="na">anyMatch</span><span class="o">(</span><span class="n">org</span> <span class="o">-&gt;</span> <span class="s">"spring-projects"</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">org</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"login"</span><span class="o">))))</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">user</span><span class="o">;</span>
        <span class="o">}</span>

        <span class="k">throw</span> <span class="k">new</span> <span class="nf">OAuth2AuthenticationException</span><span class="o">(</span><span class="k">new</span> <span class="nc">OAuth2Error</span><span class="o">(</span><span class="s">"invalid_token"</span><span class="o">,</span> <span class="s">"Not in Spring Team"</span><span class="o">,</span> <span class="s">""</span><span class="o">));</span>
    <span class="o">};</span>
<span class="o">}</span>
</code></pre></div></div>

<p>이 코드는 인증된 사용자를 대신하여 GitHub API에 액세스하기 위한 <code class="language-plaintext highlighter-rouge">WebClient</code> 인스턴스에 종속됩니다. <br />
이렇게 하면 “Spring-projects”(Spring 오픈 소스 프로젝트를 저장하는 데 사용되는 조직)와 일치하는 조직을 찾습니다. Spring Engineering 팀에 속하지 않고 성공적으로 인증하려면 자신의 값을 해당 값으로 대체할 수 있습니다. <br />
일치하는 항목이 없으면 <code class="language-plaintext highlighter-rouge">OAuth2AuthenticationException</code>을 던집니다. Spring Security에서 수신하여 401 응답으로 전환됩니다. <br /></p>

<p><code class="language-plaintext highlighter-rouge">WebClient</code>는 bean으로도 만들어야 하지만 <code class="language-plaintext highlighter-rouge">spring-boot-starter-oauth2-client</code>를 사용했기 때문에 구성 요소가 모두 자동으로 적합하기 때문에 괜찮습니다: <br /></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Bean</span>
<span class="kd">public</span> <span class="nc">WebClient</span> <span class="nf">rest</span><span class="o">(</span><span class="nc">ClientRegistrationRepository</span> <span class="n">clients</span><span class="o">,</span> <span class="nc">OAuth2AuthorizedClientRepository</span> <span class="n">authz</span><span class="o">)</span> <span class="o">{</span>
    <span class="nc">ServletOAuth2AuthorizedClientExchangeFilterFunction</span> <span class="n">oauth2</span> <span class="o">=</span>
            <span class="k">new</span> <span class="nf">ServletOAuth2AuthorizedClientExchangeFilterFunction</span><span class="o">(</span><span class="n">clients</span><span class="o">,</span> <span class="n">authz</span><span class="o">);</span>
    <span class="k">return</span> <span class="nc">WebClient</span><span class="o">.</span><span class="na">builder</span><span class="o">()</span>
            <span class="o">.</span><span class="na">filter</span><span class="o">(</span><span class="n">oauth2</span><span class="o">).</span><span class="na">build</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div></div>

<hr />

<p>확실히 위의 코드는 다른 인증 규칙으로 일반화될 수 있으며, 일부는 GitHub에 적용되고 일부는 다른 OAuth 2.0 공급자에 적용됩니다. 필요한 것은 WebClient와 공급자 API에 대한 약간의 지식뿐입니다.</p>

<hr />


      </div>

      <div class="post__share">
        <span class="share__title">Share this article:</span>
        <ul class="share__list list-reset">
          <li class="share__item">
            <a class="share__facebook" href="https://www.facebook.com/sharer/sharer.php?u=http://localhost:4000/2023/07/07/Spring-Boot-and-OAuth2/"
              onclick="window.open(this.href, 'pop-up', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"
              title="Share on Facebook" rel="nofollow"><i class="ion ion-logo-facebook"></i></a>
          </li>

          <li class="share__item">
            <a class="share__twitter" href="https://twitter.com/intent/tweet?text=Spring%20Boot%20and%20OAuth2&url=http://localhost:4000/2023/07/07/Spring-Boot-and-OAuth2/"
              onclick="window.open(this.href, 'pop-up', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"
              title="Share on Twitter" rel="nofollow"><i class="ion ion-logo-twitter"></i></a>
          </li>

          <li class="share__item">
            <a class="share__linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=http://localhost:4000/2023/07/07/Spring-Boot-and-OAuth2/&title=Spring%20Boot%20and%20OAuth2&summary=&source="
              onclick="window.open(this.href, 'pop-up', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn" rel="nofollow"><i class="ion ion-logo-linkedin"></i></a>
          </li>

          <li class="share__item">
            <a class="share__pinterest" href="http://pinterest.com/pin/create/button/?url=http://localhost:4000/2023/07/07/Spring-Boot-and-OAuth2/&amp;media=http://localhost:4000/images/post-6.jpg&amp;description=Spring%20Boot%20and%20OAuth2"
              onclick="window.open(this.href, 'pop-up', 'left=20,top=20,width=900,height=500,toolbar=1,resizable=0'); return false;" title="Share on Pinterest"
              rel="nofollow"><i class="ion ion-logo-pinterest"></i></a>
          </li>
        </ul>
      </div>
    </article>
    <!-- end post -->
    </div>
  </div>

  <div class="container">
  <div class="post__navigation">
    
    <div class="prev">
      <a class="post__nav__image" href="/2020/04/21/git-push-non-fast-forward-error/" style="background-image: url(/images/post-4.jpg)"></a>
      <h2 class="post__nav__title">
        <i class="ion ion-md-arrow-back"></i>
        <a href="/2020/04/21/git-push-non-fast-forward-error/">git push (non-fast-forward) error</a>
      </h2>
      <p class="prev__excerpt">
        
          git push origin master 후 non-fast-forward 문제



원인

파일을 올리려고 하는 깃허브 내 레파지토리와 git init한 로컬 내 저장소와 관련이 없는(unr...
        
      </p>
    </div>
    

    
    <div class="next">
      <a class="post__nav__image" href="/2023/07/15/Java-Concurrency-issues-and-ThreadLocal/" style="background-image: url(/images/post-7.jpg)">
      </a>
      <h2 class="post__nav__title">
        <a href="/2023/07/15/Java-Concurrency-issues-and-ThreadLocal/">Java 동시성 이슈와 ThreadLocal</a>
        <i class="ion ion-md-arrow-forward"></i>
      </h2>
      <p class="next__excerpt">
        
          ## Java 동시성 이슈와 쓰레드 로컬 (ThreadLocal)

### Java의 동시성 이슈
동시성 이슈 (Concurrency issues)는 다중 쓰레드 환경에서 발생하는 문제로, 여...
        
      </p>
    </div>
    
  </div>

   <!-- begin comments -->
<div class="comments">
  <div id="disqus_thread"></div>
  <script>
    (function () {
      var d = document, s = d.createElement('script');
      s.src = '//mr-brown.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
  <noscript>Please enable JavaScript to view the
    <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a>
  </noscript>
</div>
<!-- end comments --> 
  </div>

  </main>
  <!-- end content -->

  <div class="top ion ion-ios-arrow-up" title="Top"></div>

  <!-- begin search -->
<div class="search">
  <div class="container">
    <div class="row">
      <div class="col col-12">
        <div class="search__box">
          <div class="search__group">
            <div class="search__close">
              <i class="ion ion-ios-close-circle-outline"></i>
            </div>
            <label for="js-search-input" class="screen-reader-text">Search for Blog</label>
            <input type="text" id="js-search-input" class="search__text" autocomplete="off" placeholder="Type to search">
          </div>
          <ul id="js-results-container" class="search-results-list"></ul>
        </div>
      </div>
    </div>
  </div>
</div>
<!-- end search -->

  <!-- begin footer -->
<footer class="footer">
  <div class="container">

     

     

    <div class="contact">
  <ul class="contact__list list-reset">
    
    <li><a href="https://github.com/lgm1007/"><i class="ion ion-logo-github"></i></a></li>
    

     

     
  
     
  
     
  
     
  </ul>
</div>

    <div class="copyright">Copyright &copy; 2023 <a href="/">Gmlee</a> — All right Reserved. Powered by <a href="https://jekyllrb.com/">Jekyll</a>.</div>
</div>
</footer>
<!-- end footer -->


  <script src="/js/vendors/jquery-3.3.1.min.js"></script>
<script src="/js/vendors/simple-jekyll-search.min.js"></script>
<script>
  SimpleJekyllSearch({
    searchInput: document.getElementById("js-search-input"),
    resultsContainer: document.getElementById("js-results-container"),
    json: "/search.json",
    searchResultTemplate: '<li class="search-results__item"><a class="search-results__link" href="{url}">{title}</a><br> <span class="search-results__date">{date}</span></li>',
    noResultsText: '<li class="no-results">No results found</li>'
  });
</script>
<script src="/js/vendors/transition.js"></script>
<script src="/js/vendors/zoom.min.js"></script>
<script src="/js/vendors/instafeed.min.js"></script>
<script src="/js/vendors/jquery.fitvids.js"></script>
<script src="/js/common.js"></script>
</body>

</html>